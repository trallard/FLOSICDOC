.. _mesh:

==================================
 FLOSIC Mesh
==================================

In FLOSIC, the mesh is generated by specifying the accuracy of various integrals. The mesh is refined until the specified accuracy of
the integrals is accomplished. In this sense, the mesh is variational. For further details about how the mesh is generated please refer to the paper by Pederson and Jackson(Phys. Rev. B 41, 7453).
There are two types of meshes used in the calculation. One is the radial mesh used for calculations within the
atomic spheres and the other is the interstitial mesh (mesh between atomic spheres). The defaults for these are 1.E-06.
The mesh parameters are stored in the MESHDAT file. The default MESHDAT file for a DFT level calculation will look like the one below. 
It is possible to change the default mesh.
The parameters used in creating the mesh are listed in the MESHDAT file. The default MESHDAT file for a DFA calculation is as follows:


.. This is numerical problem and can be solved by refining the mesh used in the calculation. To refine a mesh see following question.


.. literalinclude:: ../input_files/meshdat.file

The default MESHDAT file for a FLOSIC calculations is shown below:


As noted above are two types of meshes used in the calculation. One is the radial mesh use for calculations within atomic spheres and the other is the interstitial mesh.

Line 1:

Line 2: The numbers in this line pertain to the radial mesh. The radial mesh is constructed to give integrations involving various Gaussians from short to long range. The small number is the error allowed in integration by the mesh. The second number, 1.2, separates the exponentials of the Gaussians which are tested i.e. the n+1st exponential is 1.2 times nth exponent. Decreasing the error tolerance will result in increase in number of mesh points and better integrals.

Line 3: The atomic sphere is divided into different concentric regions with different numbers of mesh points. The number of such radial zones is written in line 3.

Line 4: The outer radii of the radial zones.

Line 5: The mesh may be different for different atoms. For example, heavier atoms generally need denser radial meshes
near the nucleus. Hence the periodic table (upto Z=56) is divided in 4 types of meshes.

Line 6: This line shows the 4 types of meshes for atoms : first one for Z<2.1, second one for Z<10.1 and third on for Z<18.1 and the last one for Z>18.

Line 7,8,9,10: These four lines contain the parameters for each type of atomic mesh. The numbers are

**NPATS, NPIST, NTHET, NPHI, LMAX** FOR EACH RADIAL ZONE

**NPATS** :

**NPIST, NTHET, NPHI** : Before creating the mesh, the space is divided into boxes such that each atom is contained in one box. Then a sphere around the atom is assumed and the radial mesh is created. The space at the box corners between the atomic sphere and the rectangular box is divided in a different mesh. The parameters NPIST, NTHET and NPHI correspond to the mesh at the box corners.

**LMAX** : LMAX for the each radial zone. This mesh will integrate a function of the type r lmax exp(-. r2) within the given error limit in this region. Increasing LMAX results in a more refined mesh.

Line 11 : This line contains the same parameters as line 2 but for the interstitial mesh. Decreasing the error limit results in more accurate integrals in the interstitial region.

Line 12: Cutfac, mx1d

**CUTFAC**: If a box transforms into itself due to symmetry, it will be split if it is larger than cutfac times the distance to the closest atom.

**MX1D**: max. number of points in a one-dimensional interstitial partition

Line 13: Splrat

**SPLRAT**: largest allowed ratio for: the size of an atomic box divided by the distance of another atom to the box boundary


 The user can set these parameters to exercise control over the quality of calculation. For example the default mesh in FLOSIC code has been tested for FLO-SIC-LSDA calculations and is capable of providing accurate results, while the mesh required in a DFT-LDA calculation does not have to have many mesh points as in a FLO-SIC-LDA calculation. Above values are default. *Warning* When taking energy differences and comparing the energies it is advisable to ensure that same quality of mesh was used in all pertaining calculations.
