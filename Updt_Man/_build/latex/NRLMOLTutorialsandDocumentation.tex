%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english,openany,oneside]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{FLOSIC Documentation and Tutorials }
\date{Jan 31, 2023}
\release{2020}
\author{  FLOSIC developers group }
\newcommand{\sphinxlogo}{\sphinxincludegraphics{log.jpeg}\par}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{main::doc}}


\sphinxstepscope


\chapter{Introduction and Overview}
\label{\detokenize{index:introduction-and-overview}}\label{\detokenize{index:formatting-text}}\label{\detokenize{index::doc}}
\sphinxAtStartPar
The FLOSIC code is based on the UTEP version of NRLMOL, the Naval Research
Laboratory Molecular Orbital Library.{[}1\sphinxhyphen{}4{]}
NRLMOL is a massively parallel code for electronic structure calculations on molecules and clusters.
It is based on the Kohn\sphinxhyphen{}Sham (KS) formulation of density functional theory (DFT) and solves KS equations by expressing
the KS orbitals as a linear combination of Gaussian orbitals. NRLMOL was developed by Mark Pederson and collaborators.

\sphinxAtStartPar
NRLMOL contains an implementation of the Fermi\sphinxhyphen{}Löwdin orbital self\sphinxhyphen{}interaction correction (FLO\sphinxhyphen{}SIC) method{[}5\sphinxhyphen{}8{]}
that corrects the self\sphinxhyphen{}interaction error for common exchange\sphinxhyphen{}correlation functionals.
In FLO\sphinxhyphen{}SIC, the Kohn\sphinxhyphen{}Sham canonical orbitals are transformed into Fermi orbitals, which are orthogonalized to become Fermi\sphinxhyphen{}Löwdin orbitals (FLOs).
These FLOs are used to evaluate the orbital\sphinxhyphen{}dependent self\sphinxhyphen{}interaction corrected total energy. The transformation requires
a set of parameters that are points in three dimensional space, the so\sphinxhyphen{}called
Fermi\sphinxhyphen{}orbital descriptors (FODs). These FODs form what can be thought of as the electronic geometry.
The FOD positions are optimized to obtain the FLOs that minimize the total energy.
Thus, there are two geometries to consider in a FLOSIC calculation: The molecular geometry (given by the atoms) and the electronic geometry (given by the FODs).

\sphinxAtStartPar
The optimization of the FODs is a crucial part of any FLO\sphinxhyphen{}SIC calculation.
FOD optimization is analagous to a molecular geometry optimization. From a given FOD starting point,
FOD forces (energy gradients with respect to FOD positions)
are calculated and fed into a gradient\sphinxhyphen{}based optimization scheme,
along with the FOD positions and the total energy, to update FOD positions.
The optimization continues until the total energy and the FOD forces are converged.

\sphinxAtStartPar
The following is a list of some SIC\sphinxhyphen{}related properties that are calculated using the FLOSIC code:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Total energy

\item {} 
\sphinxAtStartPar
SIC contribution to the energy

\item {} 
\sphinxAtStartPar
Orbital energies

\item {} 
\sphinxAtStartPar
Orbital contributions to self\sphinxhyphen{}interaction correction; orbital moments, self\sphinxhyphen{}Coulomb, self\sphinxhyphen{}exchange, and self\sphinxhyphen{}correlation energy.

\item {} 
\sphinxAtStartPar
Analytical FOD forces (for FOD optimization using conjugate gradient or LBFGS optimizers)

\item {} 
\sphinxAtStartPar
Orbitals in .cube format

\end{itemize}

\sphinxAtStartPar
Physically interesting properties that have been evaluated recently with the FLOSIC code include:{[}9\sphinxhyphen{}14{]}
\begin{quote}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Atomization energies

\item {} 
\sphinxAtStartPar
Ionization potentials from the highest occupied orbitals

\item {} 
\sphinxAtStartPar
SIC optimized molecular geometries

\item {} 
\sphinxAtStartPar
Polarizabilities

\item {} 
\sphinxAtStartPar
Dipole moments

\item {} 
\sphinxAtStartPar
Magnetic exchange couplings

\end{itemize}

\sphinxAtStartPar
\$alpha\$
\end{quote}

\sphinxAtStartPar
The following are references to the NRLMOL code:
\begin{quote}

\sphinxAtStartPar
{[}1{]} M.R. Pederson and K.A. Jackson, \sphinxstyleemphasis{Phys. Rev. B}, \sphinxstylestrong{41}, 7453, 1990.

\sphinxAtStartPar
{[}2{]} K.A. Jackson and M.R. Pederson, \sphinxstyleemphasis{Phys. Rev. B}, \sphinxstylestrong{42}, 3276, 1990.

\sphinxAtStartPar
{[}3{]} D. Porezag and M.R. Pederson, \sphinxstyleemphasis{Phys. Rev. A}, \sphinxstylestrong{60}, 2840, 1999.

\sphinxAtStartPar
{[}4{]} M.R. Pederson et al., \sphinxstyleemphasis{phys. stat. sol. b}, \sphinxstylestrong{217}, 197, 2000.
\end{quote}

\sphinxAtStartPar
Further information about the FLO\sphinxhyphen{}SIC method can be found in the following references:
\begin{quote}

\sphinxAtStartPar
{[}5{]} M.R. Pederson, A. Ruszsinszky, J.P. Perdew., \sphinxstyleemphasis{J. Chem. Phys.}, \sphinxstylestrong{140}, 121103, 2014.

\sphinxAtStartPar
{[}6{]} M.R. Pederson, \sphinxstyleemphasis{J. Chem. Phys.}, \sphinxstylestrong{142}, 064112, 2015.

\sphinxAtStartPar
{[}7{]} Z.\sphinxhyphen{}h. Yang, M.R. Pederson, J.P. Perdew, \sphinxstyleemphasis{Phys. Rev. A}, \sphinxstylestrong{95}, 052505, 2017.

\sphinxAtStartPar
{[}8{]} M.R. Pederson, T. Baruah, \sphinxstyleemphasis{Advances In Atomic, Molecular, and Optical Physics}, Chapter 8, 2015.
\end{quote}

\sphinxAtStartPar
Applications of FLO\sphinxhyphen{}SIC are described in these references:
\begin{quote}

\sphinxAtStartPar
{[}9{]} K. Sharkas et al., \sphinxstyleemphasis{J.  Phys. Chem. A}, \sphinxstylestrong{122}, 9307\sphinxhyphen{}9315, 2018.

\sphinxAtStartPar
{[}10{]} R.P. Joshi et al., \sphinxstyleemphasis{J. Chem. Phys.},**149**, 164101, 2018.

\sphinxAtStartPar
{[}11{]} D.\sphinxhyphen{}y. Kao, K. Withanage, T. Hahn, J. Batool, J. Kortus, K. Jackson, \sphinxstyleemphasis{J. Chem. Phys}, \sphinxstylestrong{147}, 164107, 2017.

\sphinxAtStartPar
{[}12{]} S. Schwalbe, T. Hahn, S. Liebing, K. Trepte, J. Kortus, \sphinxstyleemphasis{J. Comput. Chem.}, \sphinxstylestrong{39}, 2463\sphinxhyphen{}2471, 2018.

\sphinxAtStartPar
{[}13{]} K. Withanage, K. Trepte, J.E. Peralta, T. Baruah, R. Zope, K.A. Jackson, \sphinxstyleemphasis{J. Chem. Theory Comput.}, \sphinxstylestrong{14}, 4122\sphinxhyphen{}4128, 2018.

\sphinxAtStartPar
{[}14{]} K. Trepte, S. Schwalbe, T. Hahn, J. Kortus, D.\sphinxhyphen{}y. Kao, et al., \sphinxstyleemphasis{J. Comput. Chem.}, \sphinxstylestrong{40}, 820\sphinxhyphen{}825, 2019.
\end{quote}

\sphinxstepscope


\chapter{Installing FLOSIC}
\label{\detokenize{docs/install/toc:installing-flosic}}\label{\detokenize{docs/install/toc::doc}}
\sphinxstepscope


\section{Prerequisites}
\label{\detokenize{docs/install/Prerequisites:prerequisites}}\label{\detokenize{docs/install/Prerequisites::doc}}\begin{description}
\sphinxlineitem{Hello this is my name}\begin{itemize}
\item {} 
\sphinxAtStartPar
tEST!

\item {} 
\sphinxAtStartPar
tEST@@@

\end{itemize}

\end{description}

\sphinxstepscope


\section{Accessing and compiling the code}
\label{\detokenize{docs/install/Build:accessing-and-compiling-the-code}}\label{\detokenize{docs/install/Build::doc}}
\sphinxAtStartPar
The code is accessible from a GitHub repository. To download the latest version, use a git command as follows:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
git\PYG{+w}{ }clone\PYG{+w}{ }https://github.com/FLOSIC/PublicRelease\PYGZus{}2020.git
\end{sphinxVerbatim}

\sphinxAtStartPar
Once you have obtained the code from the repository, go to the directory containing the source files.  You will
need to edit three blocks of lines in the makefile to suit your needs.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
If you have not modified a Makefile before \sphinxhyphen{} no worries!
You only have to switch a few variables.
\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{First block: parallel or serial}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} set Y or N}
\PYG{c+c1}{\PYGZsh{} Parallel compilation}
\PYG{n+nv}{MPI}\PYG{o}{=}Y
\PYG{c+c1}{\PYGZsh{} Group calculation}
\PYG{n+nv}{GROUP}\PYG{o}{=}N
\end{sphinxVerbatim}

\sphinxAtStartPar
In this block, the user specifies whether the compilation will be for a parallel (MPI=Y) or serial (MPI=N) version of the code.
When using a parallel version (MPI=Y), the user can choose to use a multi\sphinxhyphen{}level parallel scheme by setting GROUP=Y.
This parallelizes over the orbitals in calculating SIC potentials, and also over the grid points.
This option can deliver a greater speed up than the single\sphinxhyphen{}level parallel scheme, but it is not recommended for new users.

\sphinxAtStartPar
When GROUP=Y, the user should edit the “igroup” file in the run directory.  This file should contain an integer that is
an even divisor of the number of orbitals. For example, for 100 orbitals, igroup might be 10 or 20, but not 15.

\sphinxAtStartPar
\sphinxstylestrong{Second block: compiler choices}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} COMPILERS}
\PYG{n+nv}{CC}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }gcc
\PYG{n+nv}{FC}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }mpif90
\PYG{n+nv}{FFF}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }mpif90
\PYG{c+c1}{\PYGZsh{} COMPILER FLAGS}
\PYG{n+nv}{CFLAGS}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYGZhy{}O3\PYG{+w}{ }\PYGZhy{}mcmodel\PYG{o}{=}medium
\PYG{n+nv}{FFLAGS}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYGZhy{}O3\PYG{+w}{ }\PYGZhy{}mcmodel\PYG{o}{=}medium
\PYG{n+nv}{LFLAGS}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYGZhy{}O3\PYG{+w}{ }\PYGZhy{}mcmodel\PYG{o}{=}medium
\end{sphinxVerbatim}

\sphinxAtStartPar
The second block is to specify the compilers and their flags used during the compilation. A number of routines require static allocation of arrays. The code needs to be compiled for appropriate array sizes for the system under study and these static parameters are listed in the file called PARAMA2 (\sphinxstyleemphasis{vide infra})

\sphinxAtStartPar
An example of the compilers used for NERSC is below.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nv}{CC}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }cc
\PYG{n+nv}{FC}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }ftn
\PYG{n+nv}{FFF}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }ftn
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Third block: linking options}

\sphinxAtStartPar
\# Linking options

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{\PYGZdl{}(}FFF\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}LFLAGS\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}OBJ\PYG{k}{)}\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BIN\PYG{k}{)}\PYG{+w}{ }\PYGZhy{}llapack\PYG{+w}{ }\PYGZhy{}lblas\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}LIBS\PYG{k}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
This block specifies the libraries used for linking, where it is recommended to use optimized BLAS and LPACK libraries if they are available on your platform to achieve the best performance.

\sphinxAtStartPar
Edit PARAMA2 for static parameters :


\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
brief  explanation
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
\sphinxstyleemphasis{MAX\_PTS}
&
\sphinxAtStartPar
maximum size of integration grid
\\
\sphinxhline
\sphinxAtStartPar
\sphinxstyleemphasis{MX\_SPH}
&
\sphinxAtStartPar
needed to generate the integration mesh
\\
\sphinxhline
\sphinxAtStartPar
\sphinxstyleemphasis{MAXUNSYM}
&
\sphinxAtStartPar
maximum number of orbitals for an atomic basis
\\
\sphinxhline
\sphinxAtStartPar
\sphinxstyleemphasis{NDH}
&
\sphinxAtStartPar
maximum total basis set size
\\
\sphinxhline
\sphinxAtStartPar
\sphinxstyleemphasis{NDH\_TOT}
&
\sphinxAtStartPar
maximum number of Hamiltonian matrix elements
\\
\sphinxhline
\sphinxAtStartPar
\sphinxstyleemphasis{MAX\_OCC}
&
\sphinxAtStartPar
maximum number of occupied states
\\
\sphinxhline
\sphinxAtStartPar
\sphinxstyleemphasis{MX\_GRP}
&
\sphinxAtStartPar
maximum size of symmetry group
\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
An example for serial compilation on a laptop (in this case a mac) is shown below.

\sphinxAtStartPar
\sphinxstylestrong{First block:} Compile the serial version

\sphinxAtStartPar
MPI=N

\sphinxAtStartPar
GROUP=N

\sphinxAtStartPar
\sphinxstylestrong{Second block:} use gcc and gfortran compilers

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}COMPILERS}
\PYG{n+nv}{CC}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }gcc
\PYG{n+nv}{FC}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }gfortran
\PYG{n+nv}{FFF}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }gfortran

\PYG{c+c1}{\PYGZsh{}COMPILER FLAGS}
\PYG{n+nv}{CFLAGS}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYGZhy{}O3
\PYG{n+nv}{FFLAGS}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYGZhy{}O3
\PYG{n+nv}{LFLAGS}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYGZhy{}O3
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Third block:} Use the linking options under Fedora (Quantum/Luis local)

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{\PYGZdl{}(}FFF\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}LFLAGS\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}OBJ\PYG{k}{)}\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BIN\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}PCM\PYGZus{}LIBS\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}EFP\PYGZus{}LIB\PYG{k}{)}\PYG{+w}{ }\PYGZhy{}llapack\PYG{+w}{ }\PYGZhy{}lblas\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}LIBS\PYG{k}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Use the \sphinxstyleemphasis{make} command on the command line to compile FLOSIC. If the compilation was successful, an executable file titled \sphinxstylestrong{nrlmol\_exe} will be created.

\sphinxstepscope


\section{Support}
\label{\detokenize{docs/install/Support:support}}\label{\detokenize{docs/install/Support::doc}}
\sphinxAtStartPar
Please visit our repository at \sphinxurl{https://github.com/FLOSIC/PublicRelease\_2020} to access
our \sphinxhref{https://github.com/FLOSIC/PublicRelease\_2020/discussions}{Discussions} forum and to report any issues with the software.

\sphinxstepscope


\chapter{Reference}
\label{\detokenize{docs/Reference/toc:reference}}\label{\detokenize{docs/Reference/toc::doc}}
\sphinxstepscope


\section{Input and Output Files}
\label{\detokenize{docs/Reference/files:input-and-output-files}}\label{\detokenize{docs/Reference/files:nrlmolfiles}}\label{\detokenize{docs/Reference/files::doc}}
\sphinxAtStartPar
As mentioned above, the minimal set of input files required for a FLOSIC calculation includes CLUSTER and FRMORB.
Once the code is run, a number of additional files are generated. Some of these, like NRLMOL\_INPUT.DAT (described earlier) can be edited to control how subsequent calculations run. The following is a list of important input/output files and a brief description of their contents:
\begin{quote}
\begin{itemize}
\item {} 
\sphinxAtStartPar
LIST of FILES

\end{itemize}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
ATOMSPHNN: Charge and spin charge in each inequivalent atom integrated over a sphere of
specified  radius.

\item {} 
\sphinxAtStartPar
CLUSTER  : Main input file.

\item {} 
\sphinxAtStartPar
DIPOLE  : Contains x, y, z components of dipole moments in the atomic units.

\item {} 
\sphinxAtStartPar
EVALUES : The canonical eigenvalues for the current step in an SCF calculation.
If symmetry is used in the calculation, the eigenvalues are sorted by symmetry, and also by spin, if the calculation is spin\sphinxhyphen{}polarized.
A list of eigenvalues and the occupation of the corresponding orbital is given at the end of the file.

\item {} 
\sphinxAtStartPar
EVALNNN : The eigenvalues, their spin, symmetry representation, degeneracy and occupancy,
Fermi energy for each iteration number NNN.

\item {} 
\sphinxAtStartPar
FRCOUT   : Total energy, forces on each atom, dipole moment, applied electric field.

\item {} 
\sphinxAtStartPar
FRMORB : number of up spin FODs and down spin FODs, followed by the up spin FOD positions, then down spin FOD positions.

\item {} 
\sphinxAtStartPar
fande.out : Iteration, total energy, square root of the sum of the squares of FOD forces, max FOD force.

\item {} 
\sphinxAtStartPar
GEOCNVRG : Convergence criteria, Total energy , largest atomic force, information about atomic geometry
optimization.  Is written after every complete SCF cycle.

\item {} 
\sphinxAtStartPar
HISTORY:   Contains history of the geometry optimization. To see the energy as function of optimization step
do ‘grep \sphinxhyphen{}i TR HISTORY’ in the directory.

\item {} 
\sphinxAtStartPar
ISYMGEN: Information about the basis set. (For an in depth description, see chapter 8.)

\item {} 
\sphinxAtStartPar
records  : copy of the FRMORB file used during each iteration, followed by the FOD forces on those FODs.

\item {} 
\sphinxAtStartPar
RHOTOT  : Total density on a specified grid. Is written in Gaussian cubic format.

\item {} 
\sphinxAtStartPar
RHOSPN  : Spin density on a specified grid. Is written in Gaussian cubic format.

\item {} 
\sphinxAtStartPar
RUNS    :  Control restart of calculation. Calculations can be restarted from Hamiltonian (\sphinxstylestrong{HAMOLD}), wavefunctions (\sphinxstylestrong{WFOUT}), or potential (\sphinxstylestrong{COUPOT}).

\item {} 
\sphinxAtStartPar
SUMMARY : Total energy, electronic charge, kinetic energy and trace of hamiltonian for each
iteration.

\item {} 
\sphinxAtStartPar
SYMBOL : The exchange\sphinxhyphen{}correlation functional is specified on the first line. Atomic coordinates and bias potentials for each atom are stored for each
iteration of an atomic geometry optimization. The last line allows the use of a more extensive default basis set (to use, set EXTRABASIS=1).
SYMBOL includes essentially the same information as the CLUSTER file. If the SYMBOL file exists, CLUSTER is not read.

\item {} 
\sphinxAtStartPar
XMOL.DAT : Geometry in the xyz format. The first column contains atomic numbers. The atomic coordinates are in Angstrom.

\item {} 
\sphinxAtStartPar
XMOL.xyz : Geometry in the xyz format. The first column contains atomic labels. The atomic coordinates are in Angstrom. Use \sphinxstylestrong{JMOL} to visualize this.

\end{enumerate}
\end{quote}

\sphinxAtStartPar
Disclaimer: Only the primary input and output files are explained here. For more information about additional files, please contact a FLOSIC team member or post a question to the FLOSIC listserv (See Ch. 13).

\sphinxstepscope


\section{Exchange correlation functionals}
\label{\detokenize{docs/Reference/functionals:exchange-correlation-functionals}}\label{\detokenize{docs/Reference/functionals::doc}}
\sphinxAtStartPar
The exchange\sphinxhyphen{}correlation functional is specified in the CLUSTER and/or SYMBOL files. The user can currently choose to use LDA (PW92 version) or PBE functionals. The functional string needed to run them is as follows:

\sphinxAtStartPar
LDA\sphinxhyphen{}PW91*LDA\sphinxhyphen{}PW91

\sphinxAtStartPar
GGA\sphinxhyphen{}PBE*GGA\sphinxhyphen{}PBE

\sphinxAtStartPar
If the user wants to run GGA\sphinxhyphen{}PBE exchange\sphinxhyphen{}only, for example, the string will be :

\sphinxAtStartPar
GGA\sphinxhyphen{}PBE*GGA\sphinxhyphen{}NONE

\sphinxstepscope


\section{Basis sets: the ISYMGEN file}
\label{\detokenize{docs/Reference/isymgen:basis-sets-the-isymgen-file}}\label{\detokenize{docs/Reference/isymgen:usymgen}}\label{\detokenize{docs/Reference/isymgen::doc}}
\sphinxAtStartPar
The basis set information is in the ISYMGEN file which is created when you run FLOSIC.
This file contains the basis set for each atom type appearing in the calculation. For each orbital of a given atom, same set of primitive Gaussians is used. For example, the default basis set for carbon is written as below :

\sphinxAtStartPar
The following is the Pederson\sphinxhyphen{}Porezag{[}3{]} (NRLMOL default) basis in the  \sphinxstylestrong{ISYMGEN} .  The FLOSIC code
allows use of other basis sets such as : 6\sphinxhyphen{}31G*, 6\sphinxhyphen{}311G**, STO\sphinxhyphen{}3G, TZVP, DGDZVP etc.
For a full list of available basis sets, see the file basis.txt (PATH\_TO\_FLOSIC/basis/basis.txt).
The Pederson\sphinxhyphen{}Porezag (NRLMOL default) is specially optimized for the PBE functional, and roughly corresponds to quadruple zeta quality.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
   \PYG{l+m+mi}{1}          \PYG{n}{TOTAL} \PYG{n}{NUMBER} \PYG{n}{OF} \PYG{n}{ATOM} \PYG{n}{TYPES}
   \PYG{l+m+mi}{6}   \PYG{l+m+mi}{6}      \PYG{n}{ELECTRONIC} \PYG{n}{AND} \PYG{n}{NUCLEAR} \PYG{n}{CHARGE}
\PYG{n}{ALL}           \PYG{n}{ALL}\PYG{o}{\PYGZhy{}}\PYG{n}{ELECTRON} \PYG{n}{ATOM} \PYG{n}{TYPE}
   \PYG{l+m+mi}{1}          \PYG{n}{NUMBER} \PYG{n}{OF} \PYG{n}{ATOMS} \PYG{n}{OF} \PYG{n}{TYPE} \PYG{n}{CAR}
\PYG{n}{ALL}\PYG{o}{\PYGZhy{}}\PYG{n}{CAR001}
\PYG{n}{EXTRABASIS}    \PYG{n}{CONTROLS} \PYG{n}{USAGE} \PYG{n}{OF} \PYG{n}{SUPPLEMENTARY} \PYG{n}{BASIS} \PYG{n}{FUNCTIONS}
  \PYG{l+m+mi}{12}          \PYG{n}{NUMBER} \PYG{n}{OF} \PYG{n}{BARE} \PYG{n}{GAUSSIANS}
   \PYG{l+m+mi}{5}   \PYG{l+m+mi}{4}   \PYG{l+m+mi}{3}  \PYG{n}{NUMBER} \PYG{n}{OF} \PYG{n}{S}\PYG{p}{,}\PYG{n}{P}\PYG{p}{,}\PYG{n}{D} \PYG{n}{FUNCTIONS}
   \PYG{l+m+mi}{0}   \PYG{l+m+mi}{0}   \PYG{l+m+mi}{1}  \PYG{n}{SUPPLEMENTARY} \PYG{n}{S}\PYG{p}{,}\PYG{n}{P}\PYG{p}{,}\PYG{n}{D} \PYG{n}{FUNCTIONS}
       \PYG{l+m+mf}{0.2221336090}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{05}       \PYG{l+m+mf}{0.3331736980}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{04}       \PYG{l+m+mf}{0.7579013460}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{03}
       \PYG{l+m+mf}{0.2145437190}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{03}       \PYG{l+m+mf}{0.6992488940}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{02}       \PYG{l+m+mf}{0.2508613490}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{02}
       \PYG{l+m+mf}{0.9591041750}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.3802455710}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.1489185420}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}
       \PYG{l+m+mf}{0.5748765300}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.2149473200}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.7720965000}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}
 
       \PYG{l+m+mf}{0.1979224900}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.3699897740}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.6364461530}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.1012493110}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.1448078710}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.1717368870}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}
       \PYG{l+m+mf}{0.1493193200}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.6898716060}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.8607224650}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.1656669520}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{02}       \PYG{l+m+mf}{0.3776603340}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{03}      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.4710534310}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{04}
 
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.4500525960}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.8462105180}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.1449656410}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.2353560110}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.3421536850}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.4459512370}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.4526397090}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.3221641360}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.1298841970}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}
       \PYG{l+m+mf}{0.2013547140}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.1276991250}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.1413546650}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}
 
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.1000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
 
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.1000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
 
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.1000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}
 
       \PYG{l+m+mf}{0.2313862990}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.4264913270}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.7465885120}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}
       \PYG{l+m+mf}{0.1202411540}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.1835117630}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.2470680430}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.3071421870}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.3137270600}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.2672633980}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.1475658550}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.4758557640}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.7279645930}\PYG{n}{D}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{02}
 
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.1000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
 
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.1000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
 
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.1000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}
 
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.1000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
 
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.1000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
 
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.1000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
 
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}
       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.0000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{00}       \PYG{l+m+mf}{0.1000000000}\PYG{n}{D}\PYG{o}{+}\PYG{l+m+mi}{01}
 
\PYG{n}{ELECTRONS}
\PYG{n}{WFOUT}
\end{sphinxVerbatim}

\sphinxAtStartPar
Here, the second line specifies the nuclear and electronic charges in the atom. The nuclear and electronic charges specifies the actual atom (e.g. Nuc charge = 6 for carbon) but the electronic charge depends on whether all electron or pseudo potential calculations are used (e.g. for carbon it would be 6 for all electron and 4 for a pseudopotential calculation)

\sphinxAtStartPar
The third line specifies the type of calculation :

\sphinxAtStartPar
ALL for all\sphinxhyphen{}electron, BHS for BHS pseudopotential, TAB for tabulated user\sphinxhyphen{}supplied pseudopotential.

\sphinxAtStartPar
The third and fourth lines specify the number of total such atoms in the geometry
and their symbols in the SYMBOL file. EXTRABASIS =1 in SYMBOL file will signal
the program to use the supplementary basis functions. Then comes the number of
primitive Gaussians followed by the number of the s, p and d \sphinxhyphen{}type contracted
Gaussians. The number of supplementary functions of s, p and d type are written next.
These informations are followed by some blocks of numbers. The first block lists the
exponents of the primitive Gaussians. This is then followed by Ns blocks where Ns
is the number of contracted s\sphinxhyphen{}type Gaussians. The first block is the coefficients
multiplying the primitive Gaussians for the 1s contracted Gaussian, the second block
is for 2s Gaussian and so on. After the Ns number of such blocks, comes the Np blocks
corresponding to the p\sphinxhyphen{}type contracted Gaussians followed by similar Nd number of d\sphinxhyphen{}type Gaussians. In the example for carbon atom above, the 1s and 2s contracted Gaussian is a linear combination of the all the primitive Gaussians whereas the higher unoccupied s orbitals are taken as single long\sphinxhyphen{}range Gaussians. Similarly for p orbitals where only the 2p orbital is occupied. These are then followed by similar blocks corresponding to the supplementary functions.
By setting EXTRABASIS = 1 in the SYMBOL file, the additional basis functions described above are added to the calculation.  These are sometimes added when calculating dipole moments and polarizabilities.

\sphinxstepscope


\section{FLOSIC Mesh}
\label{\detokenize{docs/Reference/mesh:flosic-mesh}}\label{\detokenize{docs/Reference/mesh:mesh}}\label{\detokenize{docs/Reference/mesh::doc}}
\sphinxAtStartPar
In FLOSIC, the mesh is generated by specifying the accuracy of various integrals. The mesh is refined until the specified accuracy of
the integrals is accomplished. In this sense, the mesh is variational. For further details about how the mesh is generated please refer to the paper by Pederson and Jackson(Phys. Rev. B 41, 7453).
There are two types of meshes used in the calculation. One is the radial mesh used for calculations within the
atomic spheres and the other is the interstitial mesh (mesh between atomic spheres). The defaults for these are 1.E\sphinxhyphen{}06.
The mesh parameters are stored in the MESHDAT file. The default MESHDAT file for a DFT level calculation will look like the one below.
It is possible to change the default mesh.
The parameters used in creating the mesh are listed in the MESHDAT file. The default MESHDAT file for a DFA calculation is as follows:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
   \PYG{n}{F}                                                                     \PYG{n}{line} \PYG{l+m+mi}{1}
  \PYG{l+m+mf}{0.10000E\PYGZhy{}06}   \PYG{l+m+mf}{1.2000}                                                     \PYG{n}{line} \PYG{l+m+mi}{2}
   \PYG{l+m+mi}{6}                                                                       \PYG{n}{line} \PYG{l+m+mi}{3}
  \PYG{l+m+mf}{0.20000}      \PYG{l+m+mf}{0.40000}      \PYG{l+m+mf}{0.60000}       \PYG{l+m+mf}{1.0000}       \PYG{l+m+mf}{1.6000}              \PYG{n}{line} \PYG{l+m+mi}{4}
   \PYG{l+m+mi}{4}                                                                       \PYG{n}{line} \PYG{l+m+mi}{5}
   \PYG{l+m+mf}{2.1000}       \PYG{l+m+mf}{10.100}       \PYG{l+m+mf}{18.100}                                        \PYG{n}{line} \PYG{l+m+mi}{6}
   \PYG{l+m+mi}{2}   \PYG{l+m+mi}{1}   \PYG{l+m+mi}{3}   \PYG{l+m+mi}{5}   \PYG{l+m+mi}{5}   \PYG{l+m+mi}{7}   \PYG{l+m+mi}{9}  \PYG{l+m+mi}{11}  \PYG{l+m+mi}{19}  \PYG{l+m+mi}{21}                                   \PYG{n}{line} \PYG{l+m+mi}{7}
   \PYG{l+m+mi}{4}   \PYG{l+m+mi}{1}   \PYG{l+m+mi}{3}   \PYG{l+m+mi}{5}   \PYG{l+m+mi}{5}   \PYG{l+m+mi}{7}   \PYG{l+m+mi}{9}  \PYG{l+m+mi}{11}  \PYG{l+m+mi}{19}  \PYG{l+m+mi}{21}                                   \PYG{n}{line} \PYG{l+m+mi}{8}
   \PYG{l+m+mi}{4}   \PYG{l+m+mi}{1}   \PYG{l+m+mi}{3}   \PYG{l+m+mi}{6}   \PYG{l+m+mi}{5}   \PYG{l+m+mi}{7}   \PYG{l+m+mi}{9}  \PYG{l+m+mi}{11}  \PYG{l+m+mi}{19}  \PYG{l+m+mi}{21}                                   \PYG{n}{line} \PYG{l+m+mi}{9}
   \PYG{l+m+mi}{6}   \PYG{l+m+mi}{1}   \PYG{l+m+mi}{3}   \PYG{l+m+mi}{6}   \PYG{l+m+mi}{7}   \PYG{l+m+mi}{7}   \PYG{l+m+mi}{9}  \PYG{l+m+mi}{11}  \PYG{l+m+mi}{19}  \PYG{l+m+mi}{21}                                   \PYG{n}{line} \PYG{l+m+mi}{10}
  \PYG{l+m+mf}{0.10000E\PYGZhy{}06}   \PYG{l+m+mf}{1.2000}                                                     \PYG{n}{line} \PYG{l+m+mi}{11}
   \PYG{l+m+mf}{2.0000}       \PYG{l+m+mi}{8}                                                          \PYG{n}{line} \PYG{l+m+mi}{12}
   \PYG{l+m+mf}{2.0000}                                                                  \PYG{n}{line} \PYG{l+m+mi}{13}

\end{sphinxVerbatim}

\sphinxAtStartPar
The default MESHDAT file for a FLOSIC calculations is shown below:

\sphinxAtStartPar
As noted above are two types of meshes used in the calculation. One is the radial mesh use for calculations within atomic spheres and the other is the interstitial mesh.

\sphinxAtStartPar
Line 1:

\sphinxAtStartPar
Line 2: The numbers in this line pertain to the radial mesh. The radial mesh is constructed to give integrations involving various Gaussians from short to long range. The small number is the error allowed in integration by the mesh. The second number, 1.2, separates the exponentials of the Gaussians which are tested i.e. the n+1st exponential is 1.2 times nth exponent. Decreasing the error tolerance will result in increase in number of mesh points and better integrals.

\sphinxAtStartPar
Line 3: The atomic sphere is divided into different concentric regions with different numbers of mesh points. The number of such radial zones is written in line 3.

\sphinxAtStartPar
Line 4: The outer radii of the radial zones.

\sphinxAtStartPar
Line 5: The mesh may be different for different atoms. For example, heavier atoms generally need denser radial meshes
near the nucleus. Hence the periodic table (upto Z=56) is divided in 4 types of meshes.

\sphinxAtStartPar
Line 6: This line shows the 4 types of meshes for atoms : first one for Z\textless{}2.1, second one for Z\textless{}10.1 and third on for Z\textless{}18.1 and the last one for Z\textgreater{}18.

\sphinxAtStartPar
Line 7,8,9,10: These four lines contain the parameters for each type of atomic mesh. The numbers are

\sphinxAtStartPar
\sphinxstylestrong{NPATS, NPIST, NTHET, NPHI, LMAX} FOR EACH RADIAL ZONE

\sphinxAtStartPar
\sphinxstylestrong{NPATS} :

\sphinxAtStartPar
\sphinxstylestrong{NPIST, NTHET, NPHI} : Before creating the mesh, the space is divided into boxes such that each atom is contained in one box. Then a sphere around the atom is assumed and the radial mesh is created. The space at the box corners between the atomic sphere and the rectangular box is divided in a different mesh. The parameters NPIST, NTHET and NPHI correspond to the mesh at the box corners.

\sphinxAtStartPar
\sphinxstylestrong{LMAX} : LMAX for the each radial zone. This mesh will integrate a function of the type r lmax exp(\sphinxhyphen{}. r2) within the given error limit in this region. Increasing LMAX results in a more refined mesh.

\sphinxAtStartPar
Line 11 : This line contains the same parameters as line 2 but for the interstitial mesh. Decreasing the error limit results in more accurate integrals in the interstitial region.

\sphinxAtStartPar
Line 12: Cutfac, mx1d

\sphinxAtStartPar
\sphinxstylestrong{CUTFAC}: If a box transforms into itself due to symmetry, it will be split if it is larger than cutfac times the distance to the closest atom.

\sphinxAtStartPar
\sphinxstylestrong{MX1D}: max. number of points in a one\sphinxhyphen{}dimensional interstitial partition

\sphinxAtStartPar
Line 13: Splrat

\sphinxAtStartPar
\sphinxstylestrong{SPLRAT}: largest allowed ratio for: the size of an atomic box divided by the distance of another atom to the box boundary
\begin{quote}

\sphinxAtStartPar
The user can set these parameters to exercise control over the quality of calculation. For example the default mesh in FLOSIC code has been tested for FLO\sphinxhyphen{}SIC\sphinxhyphen{}LSDA calculations and is capable of providing accurate results, while the mesh required in a DFT\sphinxhyphen{}LDA calculation does not have to have many mesh points as in a FLO\sphinxhyphen{}SIC\sphinxhyphen{}LDA calculation. Above values are default. \sphinxstyleemphasis{Warning} When taking energy differences and comparing the energies it is advisable to ensure that same quality of mesh was used in all pertaining calculations.
\end{quote}

\sphinxstepscope


\section{Controlling a calculation: the NRLMOL\_INPUT.DAT file}
\label{\detokenize{docs/Reference/nrlmolinputdat:controlling-a-calculation-the-nrlmol-input-dat-file}}\label{\detokenize{docs/Reference/nrlmolinputdat:nrlmolinput}}\label{\detokenize{docs/Reference/nrlmolinputdat::doc}}
\sphinxAtStartPar
The \sphinxstylestrong{NRLMOL\_INPUT.DAT} is an auxiliary input file that allows setting of control parameters for calculation.  If it does not exist, then it will be
created by the FLOSIC executable using default values.

\sphinxAtStartPar
The NRLMOL\_INPUT.DAT with default values of parameters as of today (August 15, 2019) is given below.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZsh{} Put Y,N or number next to the equal sign to determine execution
\PYGZsh{} Don\PYGZsq{}t forget the quotation marks for the letters
\PYGZsh{} All variables in this list end with V

\PYGZam{}input\PYGZus{}data
ATOMSPHV      = \PYGZsq{}N\PYGZsq{}
BASISV        = \PYGZsq{}DEFAULT\PYGZsq{} ! Specify basis for calculation(basis.txt)
CALCTYPEV     = \PYGZsq{}LBFGS\PYGZsq{}
DFTD3V        = \PYGZsq{}N\PYGZsq{} ! Set to Y to do include Grimmes DFT\PYGZhy{}D3 dispersion
DIAG1V        =  1  ! diagonalization to use on regular arrays (diagge.f90)
DIAG2V        =  1  ! diagonalization to use on packed arrays (diag\PYGZus{}dspgv.f90)
DIAG3V        =  0  ! diagonalization to use on parallel (sdiagge\PYGZus{}n.f90)
DMATV         = \PYGZsq{}N\PYGZsq{} ! Create/use/mix density matrix
DOSOCCUV      = \PYGZsq{}N\PYGZsq{} ! Controls wether to calculate density of states (only in DFA)
FIXMV         = \PYGZsq{}N\PYGZsq{} ! Fix spin moment
JNTDOSV       = \PYGZsq{}N\PYGZsq{} ! This calculates jonit density of states (only in DFA)
MAXSCFV       = 100 ! Maximum SCF iterations
MIXINGV       = \PYGZsq{}P\PYGZsq{} ! (H)amiltonian (P)otential (D)ensity matrix mixing
NONSCFV       = \PYGZsq{}N\PYGZsq{} ! Set to Y to do a non SCF calculation
NONSCFFORCESV = \PYGZsq{}N\PYGZsq{} ! Set to Y to calculate forces in a non SCF calculation
NWFOUTV       = 10  ! Write WFOUT file for every N\PYGZhy{}th iteration
POPULATIONV   = \PYGZsq{}N\PYGZsq{} ! Population analysis
RHOGRIDV      = \PYGZsq{}N\PYGZsq{} ! Set to Y to execute RHOGRID
SCALEDLBFGSV  = \PYGZsq{}Y\PYGZsq{} ! Set to Y to scaled LBFGS (only in SIC)
SCFTOLV       = 1.0D\PYGZhy{}6 ! SCF tolerance
SPNPOLV       = \PYGZsq{}N\PYGZsq{} ! Run spin polarized calculation from CLUSTER
VERYFINEMESHV = \PYGZsq{}N\PYGZsq{} ! Set to Y to use very fine mesh
SYMMETRYV     = \PYGZsq{}N\PYGZsq{} ! Set to Y to detect symmetry
WFGRIDV       = \PYGZsq{}N\PYGZsq{} ! set to Y to write orbitals in cube format (only in DFA)
WFFRMV        = \PYGZsq{}N\PYGZsq{} ! set to Y to write Fermi orbitals in cube format (only in SIC)
\PYGZam{}end

\end{sphinxVerbatim}

\sphinxAtStartPar
A large number of entries related to calculation of certain properties are given as yes or no. Here \sphinxstylestrong{N} means \sphinxstyleemphasis{NO}. If \sphinxstylestrong{Y} then the calculation of a given property is requested. Note that certain calculations such as, for example, the calculation of joint density of states is often useful only at the final converged geometry.

\sphinxAtStartPar
Most of the variables are already explained briefly in the NRLMOL\_INPUT.DAT file. Below we add some comments on a few of them.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
ATOMSPHV: Set to \sphinxstylestrong{Y} to calculate charge and spin charge in each inequivalent atom integrated over a sphere of specified  radius.

\item {} 
\sphinxAtStartPar
BASISV: Default value is \sphinxstylestrong{DEFAULT} which refers to the NRLMOL basis optimized for the PBE functional.
This variable specifies which basis set is to be used. Users interested in using standard sets from the literature should look up basis.txt in the basis
subdirectory of the directory containing the source files. This file lists all the basis sets available. The user
needs to specify only the first string before the “.” from the entries in basis.txt. For example, if the user
wants to use 6\sphinxhyphen{}31G basis then he should replace DEFAULT with 6\sphinxhyphen{}31G.

\item {} 
\sphinxAtStartPar
CALCTYPEV:   Default is \sphinxstylestrong{LBFGS}.
Available choices:  \sphinxstylestrong{SCF\sphinxhyphen{}ONLY}, \sphinxstylestrong{CONJUGATE\sphinxhyphen{}GRADIENT}.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{SCF\sphinxhyphen{}ONLY} This choice is used when the user is not interested in an atomic geometry optimization. Atomic forces are not computed with this setting.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CONJUGATE\sphinxhyphen{}GRADIENT} : Atomic geometry optimization is done using the conjugate\sphinxhyphen{}gradient algorithm.

\end{itemize}

\item {} 
\sphinxAtStartPar
DIAG1V        =   Default is \sphinxstylestrong{1}
This variable allows different diagonalization algorithms to use for  diagonalization of the Hamiltonian.
\begin{quote}

\sphinxAtStartPar
The options for this variable are:
0)  DSGVX (LAPACKL: computes selected eigenvalues, and optionally eigenvectors).
1)  DSGVD (Default if matrix size is below 100).  Uses a divide and conquer algorithm to compute eigenvectors.
2)  DSGV   (This is the slowest of the available) option.
\end{quote}

\item {} 
\sphinxAtStartPar
DIAG2V        =    Default is \sphinxstylestrong{1}
This variable allows diagonalization of the Hamiltonian using packed storage format for memory savings. This is useful for large system sizes.
\begin{quote}

\sphinxAtStartPar
Available options are:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumii}{enumiii}{}{)}%
\setcounter{enumii}{-1}
\item {} 
\sphinxAtStartPar
DSPGVX (LAPACK: computes selected eigenvalues, and optionally eigenvectors).

\item {} 
\sphinxAtStartPar
DSPGVD (Default if matrix size is below 100).  Uses a divide and conquer algorithm to compute eigenvectors.

\item {} 
\sphinxAtStartPar
DSPGV (QR\sphinxhyphen{} factorization. This is the slowest of the available) option.

\end{enumerate}

\sphinxAtStartPar
The option 1 (DSPGVD) is the fastest if all eigenvectors are required otherwise use the default 0.
Note that FLOSIC doesn’t use \sphinxstylestrong{SCALAPACK}
\end{quote}

\item {} 
\sphinxAtStartPar
POPULATIONV   = Default is \sphinxstylestrong{N}
When it is set to Y, Mulliken and Lowdin Population analysis calculations are run. Note that this is available only for spin polarized calculations.

\item {} 
\sphinxAtStartPar
RHOGRIDV  = Default is \sphinxstylestrong{N}
When set to Y,  it will generate a CUBE file for visulaization of total and spin density (spin up \sphinxhyphen{} spin down).

\item {} 
\sphinxAtStartPar
SCALEDLBFGSV  = Default is \sphinxstylestrong{Y}
This indicates the FOD optimization algorithm. Here scaled LBFGS is set as the default FOD optimization routine. Conjugate Gradient is used when this option is set to ‘N’.

\end{enumerate}

\sphinxstepscope


\chapter{Quick start guide to running a FLOSIC calculation}
\label{\detokenize{docs/setupcal:quick-start-guide-to-running-a-flosic-calculation}}\label{\detokenize{docs/setupcal:setup}}\label{\detokenize{docs/setupcal::doc}}
\sphinxAtStartPar
Basic input files for FLOSIC are called “CLUSTER” and “FRMORB”.
The files require minimal input from the user and most parameters required for the calculations are set with
default values. You can specify some parameters that control the calculations in the file called “NRLMOL\_INPUT.DAT”.
A version of this file with default values is created in the run directory if it otherwise does not exist. We will
discuss the details of the parameters in the \sphinxstylestrong{NRLMOL\_INPUT.DAT} in a later section.

\sphinxAtStartPar
For now let’s work on setting up of the \sphinxstylestrong{CLUSTER} file. It is the minimal input needed to run the FLOSIC code.

\sphinxAtStartPar
An example CLUSTER file is shown below for the LiH molecule. The format is described in more detail in tutorial 1.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{GGA}\PYG{o}{\PYGZhy{}}\PYG{n}{PBE}\PYG{o}{*}\PYG{n}{GGA}\PYG{o}{\PYGZhy{}}\PYG{n}{PBE}          \PYG{p}{(}\PYG{n}{DF} \PYG{n}{TYPE} \PYG{n}{EXCHANGE}\PYG{o}{*}\PYG{n}{CORRELATION}\PYG{p}{)}
\PYG{n}{NONE}                     \PYG{p}{(}\PYG{n}{TD}\PYG{p}{,} \PYG{n}{OH}\PYG{p}{,} \PYG{n}{IH}\PYG{p}{,} \PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{XY}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{n}{OR} \PYG{n}{GRP}\PYG{p}{)}
\PYG{l+m+mi}{2}                        \PYG{p}{(}\PYG{n}{NUMBER} \PYG{n}{OF} \PYG{n}{INEQUIV}\PYG{o}{.} \PYG{n}{ATOMS} \PYG{n}{IN} \PYG{n}{CH4}\PYG{p}{)}
\PYG{l+m+mf}{0.0000}  \PYG{l+m+mf}{0.0000}  \PYG{l+m+mf}{0.0000} \PYG{l+m+mi}{3} \PYG{n}{ALL}
\PYG{l+m+mf}{0.0000}  \PYG{l+m+mf}{0.0000}  \PYG{l+m+mf}{3.0139} \PYG{l+m+mi}{1} \PYG{n}{ALL}
\PYG{l+m+mf}{0.0} \PYG{l+m+mf}{0.0}                  \PYG{p}{(}\PYG{n}{NET} \PYG{n}{CHARGE} \PYG{n}{AND} \PYG{n}{NET} \PYG{n}{SPIN}\PYG{p}{)}
 \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{OR}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}
\PYG{n+nd}{@XMOL}\PYG{o}{.}\PYG{n}{DAT}
 \PYG{n}{IF} \PYG{n}{YOU} \PYG{n}{WISH} \PYG{n}{TO} \PYG{n}{START} \PYG{n}{FROM} \PYG{n}{AN} \PYG{n}{XYZ} \PYG{n}{XMOL} \PYG{n}{FILE}
\end{sphinxVerbatim}

\sphinxAtStartPar
To run a FLOSIC calculation, a FRMORB file is required, which contains positions for FODs. An example FRMORB file is shown below for the LiH molecule defined in the CLUSTER file above.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{l+m+mi}{2} \PYG{l+m+mi}{2}
\PYG{l+m+mf}{0.000} \PYG{l+m+mf}{0.000} \PYG{l+m+mf}{0.000}
\PYG{l+m+mf}{0.000} \PYG{l+m+mf}{0.000} \PYG{l+m+mf}{2.500}
\PYG{l+m+mf}{0.000} \PYG{l+m+mf}{0.000} \PYG{l+m+mf}{0.000}
\PYG{l+m+mf}{0.000} \PYG{l+m+mf}{0.000} \PYG{l+m+mf}{2.500}
\end{sphinxVerbatim}

\sphinxAtStartPar
The first line states how many up spin FODs, and how many down spin FODs are used in the calculation. There are 2 up FODs, so the next 2 lines (lines 2\sphinxhyphen{}3)
contain x, y, \& z coordinates for up spin FODs. There are also 2 down FODs, so the last 2 coordinates are for down spin FODs (lines 4\sphinxhyphen{}5).

\sphinxAtStartPar
To create starting FOD positions, you can simply place them by hand or use an FOD generator such as the fodMC code to create them.
You can obtain a copy of the fodMC and documentation \sphinxhref{https://github.com/pyflosic/fodMC}{here}.

\sphinxAtStartPar
Before starting a FLOSIC calculation, make sure that the CALCTYPEV option in the NRLMOL\_INPUT.DAT file is set to ‘SCF\sphinxhyphen{}ONLY’ instead of ‘LBFGS’.
This ensures that atomic geometries will not be updated after each self\sphinxhyphen{}consisten energy evaluation. This is recommended practice when FOD positions are being optimized.

\sphinxAtStartPar
Try running the code using the example CLUSTER and FRMORB files given above. The final energy (EDFT+SIC) in the SUMMARY file after a completed self\sphinxhyphen{}consistent calculation should be \sphinxstylestrong{\sphinxhyphen{}8.052832898} Hartree.

\sphinxAtStartPar
You’ll notice the FOD positions in FRMORB have been moved, as they are being optimized, similar to an atomic geometry optimization at the DFT level.
Previous FOD geometries are contained in the records file, along with FOD forces.

\sphinxstepscope


\chapter{Tutorials}
\label{\detokenize{tutorials/tuttoc:tutorials}}\label{\detokenize{tutorials/tuttoc::doc}}
\sphinxstepscope


\section{Tutorial 1: Molecular geometry optimization at the DFT level}
\label{\detokenize{tutorials/dtutorials/tutorial1:tutorial-1-molecular-geometry-optimization-at-the-dft-level}}\label{\detokenize{tutorials/dtutorials/tutorial1::doc}}
\sphinxAtStartPar
Very simple  tutorial  to get acquainted with electronic structure calculations using FLOSIC. This tutorial will explain how to run FLOSIC for molecular
geometry optimizations using DFT.

\sphinxAtStartPar
The CLUSTER file is the main input file of FLOSIC. It contains the minimal information to set up a calculation. For this tutorial, we will use a CH4 molecule, which
uses a \sphinxstylestrong{CLUSTER} file like the one shown below:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{GGA}\PYG{o}{\PYGZhy{}}\PYG{n}{PBE}\PYG{o}{*}\PYG{n}{GGA}\PYG{o}{\PYGZhy{}}\PYG{n}{PBE}          \PYG{p}{(}\PYG{n}{DF} \PYG{n}{TYPE} \PYG{n}{EXCHANGE}\PYG{o}{*}\PYG{n}{CORRELATION}\PYG{p}{)}
\PYG{n}{NONE}                     \PYG{p}{(}\PYG{n}{TD}\PYG{p}{,} \PYG{n}{OH}\PYG{p}{,} \PYG{n}{IH}\PYG{p}{,} \PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{XY}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{n}{OR} \PYG{n}{GRP}\PYG{p}{)}
\PYG{l+m+mi}{5}                        \PYG{p}{(}\PYG{n}{NUMBER} \PYG{n}{OF} \PYG{n}{INEQUIV}\PYG{o}{.} \PYG{n}{ATOMS} \PYG{n}{IN} \PYG{n}{CH4}\PYG{p}{)}
 \PYG{l+m+mf}{0.0000}  \PYG{l+m+mf}{0.0000}  \PYG{l+m+mf}{0.0000} \PYG{l+m+mi}{6} \PYG{n}{ALL}
 \PYG{l+m+mf}{1.1860}  \PYG{l+m+mf}{1.1860}  \PYG{l+m+mf}{1.1860} \PYG{l+m+mi}{1} \PYG{n}{ALL}
 \PYG{l+m+mf}{1.1860} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.1860} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.1860} \PYG{l+m+mi}{1} \PYG{n}{ALL}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.1860}  \PYG{l+m+mf}{1.1860} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.1860} \PYG{l+m+mi}{1} \PYG{n}{ALL}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.1860} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.1860}  \PYG{l+m+mf}{1.1860} \PYG{l+m+mi}{1} \PYG{n}{ALL}
\PYG{l+m+mf}{0.0} \PYG{l+m+mf}{0.0}                  \PYG{p}{(}\PYG{n}{NET} \PYG{n}{CHARGE} \PYG{n}{AND} \PYG{n}{NET} \PYG{n}{SPIN}\PYG{p}{)}
 \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{OR}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}
\PYG{n+nd}{@XMOL}\PYG{o}{.}\PYG{n}{DAT}
 \PYG{n}{IF} \PYG{n}{YOU} \PYG{n}{WISH} \PYG{n}{TO} \PYG{n}{START} \PYG{n}{FROM} \PYG{n}{AN} \PYG{n}{XYZ} \PYG{n}{XMOL} \PYG{n}{FILE}
\end{sphinxVerbatim}

\sphinxAtStartPar
We will now describe the input structure of this file.

\sphinxAtStartPar
The first line is \sphinxstylestrong{GGA\sphinxhyphen{}PBE*GGA\sphinxhyphen{}PBE}.
It means that the exchange\sphinxhyphen{}correlation interactions in the systems are modeled within the generalized gradient approximation (GGA)
using the Perdew\sphinxhyphen{}Burke\sphinxhyphen{}Ernzerhof (PBE) parametrization. This is the default functional used in NRLMOL. A few other functionals are
also available.

\sphinxAtStartPar
The second line is \sphinxstylestrong{NONE} .
It refers to point group symmetry of the molecule. For the purposes of the tutorial, we will not enforce symmetry. If you would
like to use symmetry, a symmetry (TD,OH, etc.) can be selected in place of \sphinxstylestrong{NONE}. In these cases, the code will create a GRPMAT
file containing the appropriate symmetry operations (each represented by a 3x3 matrix).  If you would like to use symmetry operations
directly from an existing GRPMAT file, replace \sphinxstylestrong{NONE} with \sphinxstylestrong{GRP}.

\sphinxAtStartPar
The third line contains \sphinxstylestrong{5}.
It specifies the number of inequivalent atoms in the calculation. We’re running a CH4 calculation. So the number of atoms is 5 (1 C and 4 H).

\sphinxAtStartPar
The line following third line contains the cartesian position in atomic units of the Carbon atom. Following the xyz coordinates is the atomic charge. The example listed is for Carbon whose atomic number is 6. The string ALL means include all
(that is 6 in this case) electrons into the calculation.
The next 4 lines are the hydrogen atoms, which follow the same format.

\sphinxAtStartPar
The ninth line in the example file has two fields, charge and moment. The first field is \sphinxstylestrong{0.0} which means to perform the calculation for the neutral molecule.
If it is \sphinxstylestrong{1} then the calculations will be performed for a cation of CH4. The next field which is also \sphinxstylestrong{0.0}
in this example corresponds to the number of unpaired electrons in the system. CH4 is a closed shell system, so it has no unpaired electrons.
Lines after the Charge and Moment line are ignored.

\sphinxAtStartPar
Now, create an empty directory and execute the code inside of it. Multiple files should be created, including a CLUSTER file. Copy the input from this example into the file called CLUSTER, replacing the default text.
Change the CALCTYPE option in the NRLMOL\_INPUT.DAT file to “LBFGS” and run the calculation for CH4.
\begin{quote}

\sphinxAtStartPar
\$ \sphinxstylestrong{PATH\_TO\_FLOSIC/nrlmol\_exe}
\end{quote}

\sphinxAtStartPar
Open the \sphinxstylestrong{GEOCNVRG} file. If you have done everything correctly then it should be \sphinxstylestrong{\sphinxhyphen{}40.466969} Hartree.

\sphinxAtStartPar
A new atomic geometry will be appended to the SYMBOL file. SYMBOL is created from the data in CLUSTER. The new geometry was created by a gradient optimization
routine (either LBFGS or CONJUGATE\sphinxhyphen{}GRADIENT). The file \sphinxstylestrong{FRCOUT.G0} contains the atomic forces for the previous atomic geometry. Running
the code again will carry out a calculation at the updated molecular geometry and a new total energy and new atomic forces will be computed. A new
update of the atomic coordinates will also be written into SYMBOL. Repeating this process several times will result in a local minimum energy geometry to be
reached. This happens when the maximum force falls below the criterion set in GEOCNVRG.

\sphinxstepscope


\section{Tutorial 2: a FLOSIC calculation for H2}
\label{\detokenize{tutorials/dtutorials/tutorial2:tutorial-2-a-flosic-calculation-for-h2}}\label{\detokenize{tutorials/dtutorials/tutorial2::doc}}
\sphinxAtStartPar
In this tutorial we will learn to do a simple FLOSIC calculation.
We choose the case of the H2 molecule.
Again, as a reminder the \sphinxstylestrong{CLUSTER} file is the main input file of FLOSIC. It contains
the minimal information to set up the calculation. See below the CLUSTER file for the hydrogen molecule.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{GGA}\PYG{o}{\PYGZhy{}}\PYG{n}{PBE}\PYG{o}{*}\PYG{n}{GGA}\PYG{o}{\PYGZhy{}}\PYG{n}{PBE}            \PYG{c+c1}{\PYGZsh{} Exchange\PYGZhy{}correlation parametrization}
\PYG{n}{NONE}                       \PYG{c+c1}{\PYGZsh{} Point group of system}
\PYG{l+m+mi}{2}                          \PYG{c+c1}{\PYGZsh{} No. of atoms}
\PYG{l+m+mf}{0.0} \PYG{l+m+mf}{0.0}  \PYG{l+m+mf}{0.5}    \PYG{l+m+mi}{1}  \PYG{n}{ALL}    \PYG{c+c1}{\PYGZsh{} x,y,z coordinates, Atomic number, ALL means all electron}
\PYG{l+m+mf}{0.0} \PYG{l+m+mf}{0.0} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}    \PYG{l+m+mi}{1}  \PYG{n}{ALL}    \PYG{c+c1}{\PYGZsh{} x,y,z coordinates, Atomic number, ALL means all electron}
\PYG{l+m+mf}{0.0} \PYG{l+m+mf}{0.000}                 \PYG{c+c1}{\PYGZsh{} Charge and Moment}

\end{sphinxVerbatim}

\sphinxAtStartPar
We will now describe the input structure of this file.
The first line is \sphinxstylestrong{GGA\sphinxhyphen{}PBE*GGA\sphinxhyphen{}PBE}. It specifies that the electron\sphinxhyphen{}electron exchange and correlation interactions in the
systems are modeled within the generalized gradient approximation (GGA) using the Perdew\sphinxhyphen{}Burke\sphinxhyphen{}Ernzerhof
(PBE) parametrization. This is the default functional used in FLOSIC. A few other functionals are also
available.

\sphinxAtStartPar
The second line is \sphinxstylestrong{NONE}. It refers to point group symmetry. NONE means that there is no symmetry.
To use symmetry point groups from a GRPPMAT file, replace this with \sphinxstylestrong{GRP}. A few selected symmetry groups such as Ih, Td, Th, C3V
etc. can also be provided here. In this case the GRPMAT corresponding to specified point group will be
automatically generated by NRLMOL. Even though the H2 molecule possesses symmetry we will perform the
calculation without symmetry, so keep the \sphinxstylestrong{NONE} line as it is. A GRPMAT file will be created automatically and will contain the
identity matrix only.

\sphinxAtStartPar
The third line specifies the number of inequivalent atoms in calculations. Since we are not making use of point group
symmetry, the number of inequivalent atoms is the same as total number of atoms, which is 2 in this case.

\sphinxAtStartPar
The lines following the third line contain information for each of the inequivalent atoms.
The first three numbers are the cartesian positions in atomic units, its atomic number, and
string ALL. In this example, we have placed one hydrogen atom at (0,0,Z) and the second one at (0,0,\sphinxhyphen{}Z).
You can put the atoms anywhere. Atomic positions should be given in atomic units, Bohr.
Following the xyz coordinates is the atomic number. The example listed is for hydrogen
whose atomic number is 1. The string ALL signifies that the calculations are to be performed
at the all\sphinxhyphen{}electron level. It is also possible to use pseudopotentials. Only the BHS pseudopotentials
are hardwired into the code. It is also possible to use user\sphinxhyphen{}supplied (numerical) pseudopotentials also, but
requires more work and is not recommended for beginners.

\sphinxAtStartPar
The last line in the example has two fields. The first field is 0.0 which means perform the calculation
for the neutral molecule. If it is 1 then the calculations will be performed for singly charged
cation of the system. The next field, which is 0 in this example, corresponds to the number of unpaired
electrons in the system. There are no unpaired electrons in this example.
Lines after Charge and Moment line are ignored.

\sphinxAtStartPar
A file called \sphinxstylestrong{FRMORB} is also required, which contains the FOD positions. An example FRMORB file for H2 is shown below.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
 \PYG{l+m+mi}{1} \PYG{l+m+mi}{1}
\PYG{l+m+mf}{0.00} \PYG{l+m+mf}{0.00} \PYG{l+m+mf}{0.00}
\PYG{l+m+mf}{0.00} \PYG{l+m+mf}{0.00} \PYG{l+m+mf}{0.00}
\end{sphinxVerbatim}

\sphinxAtStartPar
The first line contains two fields. The first is the number of spin up FODs (N) and the second is the number of spin down FODs (M).
For H2, we only have one electron in each spin channel. The up FOD coordinates (x,y,z) are the following N lines.
After that is the coordinates (x,y,z) of the M spin down FODs

\sphinxAtStartPar
To avoid optimizing atomic geometries, change the CALCTYPE field in NRLMOL\_INPUT.DAT from LBFGS to SCF\sphinxhyphen{}ONLY. This is recommended for FLOSIC
calculations when the FODs are being optimized.

\sphinxAtStartPar
Now, copy the example input files called CLUSTER and FRMORB into an empty directory. Run the calculation for the H2 molecule
using the following command at the prompt.
\begin{quote}

\sphinxAtStartPar
\$ \sphinxstylestrong{PATH\_TO\_FLOSIC/nrlmol\_exe \textgreater{} print}
\end{quote}

\sphinxAtStartPar
Now, browse through the file SUMMARY and look at the energies printed at each iteration of the SCF cycle. You should see that the minimum
total energy is reached at self\sphinxhyphen{}consistency.
Also, look at the EVALUES file in which Kohn\sphinxhyphen{}Sham eigenvalues and occupation numbers are printed.

\sphinxAtStartPar
The FOD forces are displayed in the records file, which has the same format as FRMORB, followed by the FOD forces in the same order.

\sphinxAtStartPar
The fande.out file contains the iteration, total DFT+SIC energy, square root of the sum of the squares of the FOD forces, and the max FOD force.
When optimizing FODs, this is a good file to check for the convergence of FOD forces.

\sphinxAtStartPar
After completing a self\sphinxhyphen{}consistent calculation, the FOD forces are used in a gradient optimization scheme to update the FOD positions.
These are written into the FRMORB file.  Re\sphinxhyphen{}running the code will cause another self\sphinxhyphen{}consistent calculation to be performed, using the
updated FOD positions.  A new total energy and new FOD forces will be calculated, and the FOD positions will again be updated.
Repeating this process will result in the optimization of the FOD positions.  Convergence can be gauged by the size by the largest FOD
force.  When this drops below a chosen convergence criterion, the FODs are optimized.

\sphinxAtStartPar
To further optimize FODs, repeatedly run the code until the calculation is optimized to your criterion.
A simple iterative loop can help with this process.

\sphinxAtStartPar
For the example of H2, there is only one FOD of each spin. Placing the FODs at any position in space
for such a case will give the same energy and the force on the FOD will therefore be zero.

\sphinxstepscope


\section{Tutorial 3:  FOD optimization of a water molecule}
\label{\detokenize{tutorials/dtutorials/T3-FOD_opt:tutorial-3-fod-optimization-of-a-water-molecule}}\label{\detokenize{tutorials/dtutorials/T3-FOD_opt::doc}}
\sphinxAtStartPar
This tutorial explains how to do a FODs optimization taking the example of the water molecule. It is recommended to run a DFT calculation first to get the DFT optimized density. To do this, we start from the usual CLUSTER file:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{GGA}\PYG{o}{\PYGZhy{}}\PYG{n}{PBE}\PYG{o}{*}\PYG{n}{GGA}\PYG{o}{\PYGZhy{}}\PYG{n}{PBE}      \PYG{p}{(}\PYG{n}{DF} \PYG{n}{TYPE} \PYG{n}{EXCHANGE}\PYG{o}{*}\PYG{n}{CORRELATION}\PYG{p}{)}
\PYG{n}{NONE}                 \PYG{p}{(}\PYG{n}{TD}\PYG{p}{,} \PYG{n}{OH}\PYG{p}{,} \PYG{n}{IH}\PYG{p}{,} \PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{XY}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{n}{OR} \PYG{n}{GRP}\PYG{p}{)}
\PYG{l+m+mi}{3}                    \PYG{p}{(}\PYG{n}{NUMBER} \PYG{n}{OF} \PYG{n}{ATOMS}\PYG{p}{)}
  \PYG{l+m+mf}{0.000}   \PYG{l+m+mf}{0.000}   \PYG{l+m+mf}{0.0}   \PYG{l+m+mi}{8}  \PYG{n}{ALL}  \PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{n}{Z}\PYG{p}{,} \PYG{n}{ALL}\PYG{o}{\PYGZhy{}}\PYG{n}{ELECTRON}\PYG{p}{)}
  \PYG{l+m+mf}{1.443}   \PYG{l+m+mf}{1.128}   \PYG{l+m+mf}{0.0}   \PYG{l+m+mi}{1}  \PYG{n}{ALL}  \PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{n}{Z}\PYG{p}{,} \PYG{n}{ALL}\PYG{o}{\PYGZhy{}}\PYG{n}{ELECTRON}\PYG{p}{)}
 \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.443}   \PYG{l+m+mf}{1.128}   \PYG{l+m+mf}{0.0}   \PYG{l+m+mi}{1}  \PYG{n}{ALL}  \PYG{p}{(}\PYG{n}{R}\PYG{p}{,} \PYG{n}{Z}\PYG{p}{,} \PYG{n}{ALL}\PYG{o}{\PYGZhy{}}\PYG{n}{ELECTRON}\PYG{p}{)}
 \PYG{l+m+mf}{0.000}   \PYG{l+m+mf}{0.000}                  \PYG{p}{(}\PYG{n}{NET} \PYG{n}{CHARGE} \PYG{n}{AND} \PYG{n}{NET} \PYG{n}{SPIN}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
In the NRLMOL\_INPUT.DAT file we change CALCTYPEV from ‘LBFGS’ to ‘SCF\sphinxhyphen{}ONLY’ to switch off the molecular optimization. We also turn on the unrestricted calculation setting SPNPOLV = ‘Y’. Then we run NRLMOL in a new directory with only CLUSTER and NRLMOL\_INPUT.DAT files:
\begin{quote}

\sphinxAtStartPar
\$ \sphinxstylestrong{PATH\_TO\_FLOSIC/nrlmol\_exe \textgreater{} print.DFT}
\end{quote}

\sphinxAtStartPar
All the normal NRLMOL outputs are generated. If the calculation finished correctly, we should have the following RUNS file

\begin{sphinxVerbatim}[commandchars=\\\{\}]
     \PYG{l+m+mi}{0}     \PYG{l+m+mi}{1}            \PYG{n}{ITBEG}\PYG{p}{,} \PYG{n}{NCALC}
     \PYG{l+m+mi}{4}     \PYG{l+m+mi}{4}            \PYG{n}{START}\PYG{p}{:} \PYG{l+m+mi}{0}\PYG{o}{=}\PYG{n}{SCR}\PYG{o}{.}\PYG{n}{NUC}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{o}{=}\PYG{n}{HAM}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{o}{=}\PYG{n}{POT}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{o}{=}\PYG{n}{LSF}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{o}{=}\PYG{n}{WFUNC}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{o}{=}\PYG{n}{WFUNC\PYGZus{}FRAG}
     \PYG{l+m+mi}{0}                  \PYG{n}{START} \PYG{n}{HAMILTONIAN} \PYG{n}{IS} \PYG{n}{INTERPOLATED}\PYG{p}{:} \PYG{l+m+mi}{0}\PYG{o}{=}\PYG{n}{NO}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{o}{=}\PYG{n}{YES}
\end{sphinxVerbatim}

\sphinxAtStartPar
The second number in the first line may be different if a molecular optimization was carried out. It is important to check that we have 4 4 in the second line. This tells FLOSIC to use the wave function stored in WFOUT to start the next calculation.

\sphinxAtStartPar
Now, we have to include the FOD positions. Here, we can use the Monte Cartlo FOD generator \sphinxstylestrong{fodMC}. For that, we copy XMOL.xyz into a file named \sphinxstylestrong{system} and edit the second and last lines as shown:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
    \PYG{l+m+mi}{3}
\PYG{n}{angstrom}  \PYG{n}{fix1s}
 \PYG{n}{O}     \PYG{l+m+mf}{0.00000}    \PYG{l+m+mf}{0.00000}    \PYG{l+m+mf}{0.00000}
 \PYG{n}{H}     \PYG{l+m+mf}{0.76360}    \PYG{l+m+mf}{0.59691}    \PYG{l+m+mf}{0.00000}
 \PYG{n}{H}    \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.76360}    \PYG{l+m+mf}{0.59691}    \PYG{l+m+mf}{0.00000}
\PYG{n}{con\PYGZus{}mat}

\end{sphinxVerbatim}

\sphinxAtStartPar
It might have an empty line at the end. The fodMC code and documentation can be found \sphinxhref{https://github.com/pyflosic/fodMC}{here}. When fodMC is executed 3 files are generated: \sphinxstylestrong{CLUSTER}, \sphinxstylestrong{FRMORB} and \sphinxstylestrong{Nuc\_FOD.xyz}. Thus, it will overwrite our \sphinxstylestrong{CLUSTER} file if executed in the same directory. In our case, it does not matter because whenever the \sphinxstylestrong{SYMBOL} file is present \sphinxstylestrong{CLUSTER} is ignored. \sphinxstylestrong{FRMORB} contains the FODs in Bohrs for the unrestricted calculation (first the up, then the down). You should get something like this:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
  \PYG{l+m+mi}{5}       \PYG{l+m+mi}{5}
   \PYG{l+m+mf}{0.0000000000000000}        \PYG{l+m+mf}{0.0000000000000000}        \PYG{l+m+mf}{0.0000000000000000}     
   \PYG{l+m+mf}{1.2265460953713494}       \PYG{l+m+mf}{0.95879731507086485}        \PYG{l+m+mf}{0.0000000000000000}     
  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.2265460953713494}       \PYG{l+m+mf}{0.95879731507086485}        \PYG{l+m+mf}{0.0000000000000000}     
   \PYG{l+m+mf}{9.8690853618931581E\PYGZhy{}005} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.84709659045951247}       \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.0165159441533127}     
  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.5276582823942571E\PYGZhy{}005} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.84709659045951247}        \PYG{l+m+mf}{1.0165159488293354}     
   \PYG{l+m+mf}{0.0000000000000000}        \PYG{l+m+mf}{0.0000000000000000}        \PYG{l+m+mf}{0.0000000000000000}     
   \PYG{l+m+mf}{9.8690853618931581E\PYGZhy{}005} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.84709659045951247}       \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.0165159441533127}     
  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.5276582823942571E\PYGZhy{}005} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.84709659045951247}        \PYG{l+m+mf}{1.0165159488293354}     
   \PYG{l+m+mf}{1.2265461383759642}       \PYG{l+m+mf}{0.95879734868779065}        \PYG{l+m+mf}{0.0000000000000000}     
  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.2265461383759642}       \PYG{l+m+mf}{0.95879734868779065}        \PYG{l+m+mf}{0.0000000000000000}     
\end{sphinxVerbatim}

\sphinxAtStartPar
If you do not have fodMC, you can copy\sphinxhyphen{}paste the previous \sphinxstylestrong{FRMORB}. It is important to always check how the FODs are distributed. For that, you can visualize \sphinxstylestrong{Nuc\_FOD.xyz} with the software of your choice. The spin up FODs have the label X and the down FODs have the symbol He by default, so be careful if the He atom is included in your system.

\sphinxAtStartPar
Running the FLOSIC code again in this directory will now cause a FLO\sphinxhyphen{}SIC\sphinxhyphen{}PBE calculation to be run.  (The existence of FRMORB is the flag for running a FLO\sphinxhyphen{}SIC calculation).
\begin{quote}

\sphinxAtStartPar
\$ \sphinxstylestrong{PATH\_TO\_FLOSIC/nrlmol\_exe \textgreater{} print.001}
\end{quote}

\sphinxAtStartPar
If everything goes well, we get now all the FLOSIC output files. Check the \sphinxstylestrong{SUMMARY} file. It should look like this (note that some columns of this file do not fit on the page):

\begin{sphinxVerbatim}[commandchars=\\\{\}]
  \PYG{n}{IT}          \PYG{n}{TRACE}                \PYG{n}{ETOT}                 \PYG{n}{EKIN}\PYG{o}{+}\PYG{n}{ENONLOC}          \PYG{n}{CHARGE}              \PYG{n}{EDFT}\PYG{o}{+}\PYG{n}{SIC}              \PYG{n}{LOWEST}
   \PYG{l+m+mi}{1}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{42.416153386}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.326968147}         \PYG{l+m+mf}{76.469793374}          \PYG{l+m+mf}{9.999999301}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.326968147}          \PYG{l+m+mf}{0.000000000}
   \PYG{l+m+mi}{2}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{40.529422883}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.287479323}         \PYG{l+m+mf}{74.155137275}          \PYG{l+m+mf}{9.999999484}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.287479323}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.326968147}
   \PYG{l+m+mi}{3}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{41.037801666}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.360861763}         \PYG{l+m+mf}{75.120435771}          \PYG{l+m+mf}{9.999999577}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.360861763}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.287479323}
   \PYG{l+m+mi}{4}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{41.547677518}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.386605548}         \PYG{l+m+mf}{76.071092878}          \PYG{l+m+mf}{9.999999652}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.386605548}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.360861763}
   \PYG{l+m+mi}{5}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{41.579433885}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387012272}         \PYG{l+m+mf}{76.156784862}          \PYG{l+m+mf}{9.999999660}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387012272}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.386605548}
   \PYG{l+m+mi}{6}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{41.537373241}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387091483}         \PYG{l+m+mf}{76.105263133}          \PYG{l+m+mf}{9.999999659}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387091483}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387012272}
   \PYG{l+m+mi}{7}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{41.535132409}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387091342}         \PYG{l+m+mf}{76.101118384}          \PYG{l+m+mf}{9.999999659}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387091342}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387091483}
   \PYG{l+m+mi}{8}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{41.541270575}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387093972}         \PYG{l+m+mf}{76.111112778}          \PYG{l+m+mf}{9.999999661}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387093972}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387091342}
  \PYG{n}{IT}          \PYG{n}{TRACE}                \PYG{n}{ETOT}                 \PYG{n}{EKIN}\PYG{o}{+}\PYG{n}{ENONLOC}          \PYG{n}{CHARGE}              \PYG{n}{EDFT}\PYG{o}{+}\PYG{n}{SIC}              \PYG{n}{LOWEST}
   \PYG{l+m+mi}{1}          \PYG{l+m+mf}{0.000000000}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.387093972}         \PYG{l+m+mf}{76.111112778}          \PYG{l+m+mf}{9.999999661}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.325884480}          \PYG{l+m+mf}{0.000000000}
   \PYG{l+m+mi}{2}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.383872787}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.377766430}         \PYG{l+m+mf}{75.943917202}          \PYG{l+m+mf}{9.999999707}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.336806819}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.325884480}
   \PYG{l+m+mi}{3}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.434397301}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.376079958}         \PYG{l+m+mf}{76.027004027}          \PYG{l+m+mf}{9.999999708}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337098863}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.336806819}
   \PYG{l+m+mi}{4}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.441559320}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.375691097}         \PYG{l+m+mf}{76.055957777}          \PYG{l+m+mf}{9.999999706}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337109578}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337098863}
   \PYG{l+m+mi}{5}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.324136604}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.375845538}         \PYG{l+m+mf}{75.998150088}          \PYG{l+m+mf}{9.999999702}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337049496}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337109578}
   \PYG{l+m+mi}{6}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.312036177}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.376132863}         \PYG{l+m+mf}{76.000962346}          \PYG{l+m+mf}{9.999999700}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337038707}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337049496}
   \PYG{l+m+mi}{7}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.315234163}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.376185290}         \PYG{l+m+mf}{76.002987681}          \PYG{l+m+mf}{9.999999700}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337041096}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337038707}
   \PYG{l+m+mi}{8}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.332770384}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.376285169}         \PYG{l+m+mf}{76.024925697}          \PYG{l+m+mf}{9.999999700}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337087551}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337041096}
   \PYG{l+m+mi}{9}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.303951079}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.376194186}         \PYG{l+m+mf}{75.999998287}          \PYG{l+m+mf}{9.999999700}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337026990}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337087551}
  \PYG{l+m+mi}{10}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.374868090}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.376350868}         \PYG{l+m+mf}{76.064567671}          \PYG{l+m+mf}{9.999999702}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337132117}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337026990}
  \PYG{l+m+mi}{11}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.381393225}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.376294921}         \PYG{l+m+mf}{76.083303549}          \PYG{l+m+mf}{9.999999703}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337128855}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337132117}
  \PYG{l+m+mi}{12}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.365402178}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.376255647}         \PYG{l+m+mf}{76.070377576}          \PYG{l+m+mf}{9.999999703}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337133358}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337128855}
  \PYG{l+m+mi}{13}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.358580387}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.376246217}         \PYG{l+m+mf}{76.060102340}          \PYG{l+m+mf}{9.999999702}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337132539}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337133358}
  \PYG{l+m+mi}{14}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{47.369783782}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.376261648}         \PYG{l+m+mf}{76.069168121}          \PYG{l+m+mf}{9.999999702}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337133952}        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337132539}
\end{sphinxVerbatim}

\sphinxAtStartPar
The first block is for the normal DFT calculation with the 3rd and 6th column exactly the same (no SIC). The second block is for the FLOSIC run. In the standard output file \textendash{} renamed print.001 in this example (see the execution line above) \textendash{} search for the word ITERATION.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ITERATION}   \PYG{l+m+mi}{1}
\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{=}
\PYG{n}{READING} \PYG{n}{OLD} \PYG{n}{WAVEFUNCTIONS} \PYG{n}{FROM} \PYG{n}{FILE} \PYG{n}{WFOUT}
 \PYG{n}{MREP} \PYG{o}{=}           \PYG{l+m+mi}{1}
 \PYG{n}{N\PYGZus{}OCC}\PYG{p}{,} \PYG{n}{NBASF} \PYG{o}{=}           \PYG{l+m+mi}{5}          \PYG{l+m+mi}{73}          \PYG{l+m+mi}{73}
 \PYG{n}{N\PYGZus{}OCC}\PYG{p}{,} \PYG{n}{NBASF} \PYG{o}{=}           \PYG{l+m+mi}{5}          \PYG{l+m+mi}{73}          \PYG{l+m+mi}{73}
\end{sphinxVerbatim}

\sphinxAtStartPar
There it states that the wave function is read from WFOUT and gives the occupied and total number of orbitals. After giving the occupancies, it calculates the Lowdin overlap eigenvalues.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{LOWDEN} \PYG{n}{OVERLAP} \PYG{n}{EIGENVALUES}\PYG{p}{:}
    \PYG{l+m+mf}{0.751388}       \PYG{l+m+mf}{0.791811}        \PYG{l+m+mf}{1.06742}        \PYG{l+m+mf}{1.07216}        \PYG{l+m+mf}{1.31722}
\PYG{n}{BACK} \PYG{n}{FROM} \PYG{n}{LOWSIC}
\PYG{n}{CALLING} \PYG{n}{DIAGGE}\PYG{p}{:}        \PYG{l+m+mi}{1000}           \PYG{l+m+mi}{5}
\PYG{n}{LOWDEN} \PYG{n}{OVERLAP} \PYG{n}{EIGENVALUES}\PYG{p}{:}
    \PYG{l+m+mf}{0.751388}       \PYG{l+m+mf}{0.791811}        \PYG{l+m+mf}{1.06742}        \PYG{l+m+mf}{1.07216}        \PYG{l+m+mf}{1.31722}
\end{sphinxVerbatim}

\sphinxAtStartPar
These values correspond to the eigenvalues of the overlap matrix formed from the Fermi orbitals.  This is diagonalized in the Lowdin process.  When one or more of these eigenvalues are smaller than 1E\sphinxhyphen{}08, it means that two or more of the Fermi orbitals are identical and the calculation stops with a message of bad FOD positions. At the end of the SCF cycle we get the following summary of energy contributions. Some of them are in the \sphinxstylestrong{SUMMARY} file too.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{SUMMARY} \PYG{n}{OF} \PYG{n}{ENERGY} \PYG{n}{CONTRIBUTIONS}\PYG{p}{:}
\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}\PYG{o}{==}
\PYG{n}{TOTAL} \PYG{n}{ENERGY}\PYG{p}{:}                         \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337134}
\PYG{n}{NUCLEAR} \PYG{n}{REPULSION}\PYG{p}{:}                      \PYG{l+m+mf}{9.082196}
\PYG{n}{LOCAL} \PYG{n}{POTENTIAL}\PYG{p}{:}                     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{198.922706}
\PYG{n}{MEAN}\PYG{o}{\PYGZhy{}}\PYG{n}{FIELD} \PYG{n}{COULOMB}\PYG{p}{:}                    \PYG{l+m+mf}{46.647189}
\PYG{n}{NONLOCAL} \PYG{n}{POTENTIAL}\PYG{p}{:}                     \PYG{l+m+mf}{0.000000}
\PYG{n}{KINETIC}\PYG{p}{:}                               \PYG{l+m+mf}{76.069168}
\PYG{n}{LOCAL} \PYG{n}{EXCHANGE}\PYG{p}{:}                        \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{8.108217}
\PYG{n}{LOCAL} \PYG{n}{CORRELATION}\PYG{p}{:}                     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.660695}
\PYG{n}{NONLOCAL} \PYG{n}{EXCHANGE}\PYG{p}{:}                     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.816267}
\PYG{n}{NONLOCAL} \PYG{n}{CORRELATION}\PYG{p}{:}                   \PYG{l+m+mf}{0.333071}
\PYG{n}{EXTERNAL} \PYG{n}{ELECTRIC} \PYG{n}{FIELD}\PYG{p}{:}                \PYG{l+m+mf}{0.000000}
\end{sphinxVerbatim}

\sphinxAtStartPar
Once self\sphinxhyphen{}consistency is reached, the FOD forces are calculated and FOD positions are updated in \sphinxstylestrong{FRMIDT} (and/or in \sphinxstylestrong{FRMORB}) using the chosen optimization method. The default is scaled LBFGS, but it sometimes gets stuck or fails to obtain the next step. In those cases, we may switch off this variable in \sphinxstylestrong{NRLMOL\_INPUT.DAT} SCALEDLBFGSV = ‘N’ to use the conjuged gradient for the FOD optimization. As the FODs are already updated and we also have the wave function and the \sphinxstylestrong{RUNS} file, we just run FLOSIC in the same directory to do the SCF cycle with the new FODs.
\begin{quote}

\sphinxAtStartPar
\$ \sphinxstylestrong{PATH\_TO\_FLOSIC/nrlmol\_exe \textgreater{} print.002}
\end{quote}

\sphinxAtStartPar
We can sucessively do this or use a script similar to that in the previous tutorial. After doing 5 steps of FOD optimization we can see in \sphinxstylestrong{fande.out} how the energy is decreasing and converging and the forces diminishing (not at every step).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
    \PYG{l+m+mi}{1}    \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337133952182}  \PYG{l+m+mf}{0.533401361320E\PYGZhy{}02}  \PYG{l+m+mf}{0.376016287388E\PYGZhy{}02}
    \PYG{l+m+mi}{2}    \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.336140893884}  \PYG{l+m+mf}{0.316012354712E\PYGZhy{}01}  \PYG{l+m+mf}{0.222645230322E\PYGZhy{}01}
    \PYG{l+m+mi}{3}    \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337242375732}  \PYG{l+m+mf}{0.165238505484E\PYGZhy{}02}  \PYG{l+m+mf}{0.109072276621E\PYGZhy{}02}
    \PYG{l+m+mi}{4}    \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337256822409}  \PYG{l+m+mf}{0.184877969533E\PYGZhy{}02}  \PYG{l+m+mf}{0.129662662282E\PYGZhy{}02}
    \PYG{l+m+mi}{5}    \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{76.337254671865}  \PYG{l+m+mf}{0.203173772471E\PYGZhy{}03}  \PYG{l+m+mf}{0.997893243061E\PYGZhy{}04}
\end{sphinxVerbatim}

\sphinxAtStartPar
All the used FODs, obtained forces, and corrected total energies can be seen in the \sphinxstylestrong{records} file.

\sphinxstepscope


\section{Plotting density of states using NRLMOL}
\label{\detokenize{tutorials/ddos/density_of_states:plotting-density-of-states-using-nrlmol}}\label{\detokenize{tutorials/ddos/density_of_states::doc}}

\subsection{Introduction}
\label{\detokenize{tutorials/ddos/density_of_states:introduction}}
\sphinxAtStartPar
Once you start using NRLMOL, eventually you will need to plot the density of states for the system that you are running. The process can get a little messy so this guide should solve out some doubts.

\sphinxAtStartPar
First of, what are densities of states?

\sphinxAtStartPar
Basically, it’s the number of electronic states at a given energy, and is one of the most important quantities to describe the electronic state of a structure {[}1{]}.

\sphinxAtStartPar
They are calculated via this:
\(\rho(E)=\frac{1}{N_k}\sum\limits_{i,k}\delta(\epsilon_{i,k}-E)\)

\sphinxAtStartPar
where \(\rho(E)\) is the number of independent\sphinxhyphen{}particles states per unit energy, \(\epsilon_{i,k}\) denotes the energy of an electron {[}2{]}.

\sphinxAtStartPar
The plots themselves are more qualitative than quantitative, since they tell us the localization of states within an energy interval, but the exact number of states for a given energy is rather unimportant. For our purposes (photovoltaics), we are interested mailnly in checking that the last occupied state (that is, the HOMO) is localized in the donor, and that the first unoccupied state (LUMO) resides in the acceptor.


\subsection{Setup}
\label{\detokenize{tutorials/ddos/density_of_states:setup}}
\sphinxAtStartPar
So let’s do this by example. Let us do the calculation for the density of states for a system we have used previously, Tetracyanoethylene Benzene, or TCNE\sphinxhyphen{}Benzene. This is compound molecule made up of two components: the TCNE and Benzene, here the TCNE is in front and the benzene is in the backgound (Fig. 1).

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[scale=0.8]{{tcne_img}.png}
\end{figure}

\sphinxAtStartPar
The \sphinxstylestrong{CLUSTER} file to run the calculation of this structure is:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{GGA}\PYG{o}{\PYGZhy{}}\PYG{n}{PBE}\PYG{o}{*}\PYG{n}{GGA}\PYG{o}{\PYGZhy{}}\PYG{n}{PBE}
\PYG{n}{GRP}
          \PYG{l+m+mi}{22}  \PYG{n}{Number} \PYG{n}{of} \PYG{n}{inequivalent} \PYG{n}{atoms}
       \PYG{l+m+mf}{0.0000}      \PYG{l+m+mf}{4.7079}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9776}   \PYG{l+m+mi}{1} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{0.0000}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{4.7079}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9776}   \PYG{l+m+mi}{1} \PYG{n}{ALL} \PYG{n}{UPO} 
       \PYG{l+m+mf}{4.0794}      \PYG{l+m+mf}{2.3559}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9732}   \PYG{l+m+mi}{1} \PYG{n}{ALL} \PYG{n}{UPO} 
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{4.0794}      \PYG{l+m+mf}{2.3559}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9732}   \PYG{l+m+mi}{1} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{4.0794}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.3559}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9732}   \PYG{l+m+mi}{1} \PYG{n}{ALL} \PYG{n}{UPO}
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{4.0794}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.3559}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9732}   \PYG{l+m+mi}{1} \PYG{n}{ALL} \PYG{n}{UPO}
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{4.1665}      \PYG{l+m+mf}{3.8824}      \PYG{l+m+mf}{2.9754}   \PYG{l+m+mi}{7} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{4.1665}      \PYG{l+m+mf}{3.8824}      \PYG{l+m+mf}{2.9754}   \PYG{l+m+mi}{7} \PYG{n}{ALL} \PYG{n}{UPO}
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{4.1665}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.8824}      \PYG{l+m+mf}{2.9754}   \PYG{l+m+mi}{7} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{4.1665}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.8824}      \PYG{l+m+mf}{2.9754}   \PYG{l+m+mi}{7} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{0.0000}      \PYG{l+m+mf}{2.6433}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9697}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{0.0000}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.6433}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9697}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{2.2925}      \PYG{l+m+mf}{1.3220}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9702}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.2925}      \PYG{l+m+mf}{1.3220}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9702}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{2.2925}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.3220}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9702}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.2925}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.3220}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.9702}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{0.0000}      \PYG{l+m+mf}{1.2969}      \PYG{l+m+mf}{2.9150}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{0.0000}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.2969}      \PYG{l+m+mf}{2.9150}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.3072}      \PYG{l+m+mf}{2.7100}      \PYG{l+m+mf}{2.9357}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{2.3072}      \PYG{l+m+mf}{2.7100}      \PYG{l+m+mf}{2.9357}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.3072}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.7100}      \PYG{l+m+mf}{2.9357}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{2.3072}     \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.7100}      \PYG{l+m+mf}{2.9357}   \PYG{l+m+mi}{6} \PYG{n}{ALL} \PYG{n}{UPO}
       \PYG{l+m+mf}{0.0000}      \PYG{l+m+mf}{0.0000} \PYG{n}{Net} \PYG{n}{Charge} \PYG{o+ow}{and} \PYG{n}{Moment}
\end{sphinxVerbatim}

\sphinxAtStartPar
However, density of states is not a calculation that is normally done when you run NRLMOL, it has to be requested as a post\sphinxhyphen{}convergence calculation. That is, once the SCF cycle has converged, this calculation is now executed.

\sphinxAtStartPar
In order to request it, you have to set the option \sphinxstyleemphasis{DOSOCCUV} to \sphinxstyleemphasis{‘Y’} in the \sphinxstylestrong{NRLMOL\_INPUT.DAT} file. For older versions of NRLMOL, you have to create an empty file called \sphinxstylestrong{DOSOCCU} to request the calculation.

\sphinxAtStartPar
So, to get the density of states calculated, you need the following:
\begin{itemize}
\item {} 
\sphinxAtStartPar
The binary file (the program itself)

\item {} 
\sphinxAtStartPar
The \sphinxstylestrong{CLUSTER} file

\item {} 
\sphinxAtStartPar
Either the \sphinxstylestrong{NRLMOL\_INPUT.DAT} with the option set or an empty file called \sphinxstylestrong{DOSOCCU}

\end{itemize}


\subsection{Results}
\label{\detokenize{tutorials/ddos/density_of_states:results}}
\sphinxAtStartPar
Once the program finishes, it should have generated a list of files called \sphinxstylestrong{DOSO001}, \sphinxstylestrong{DOSO002}, and so forth (one for every atom in the structure you ran, there should be 22 files for our case of TCNE\sphinxhyphen{}Benzene).

\sphinxAtStartPar
The files may also have other starting names (\sphinxstylestrong{AF1O, AF2O, MINO, MAJO}) depending on the type of calculation you set up.

\sphinxAtStartPar
So basically, we have a density of states file for every atom in our system that we must plot, but how do we know which file corresponds to what atom? Do we follow the order from the \sphinxstylestrong{CLUSTER} file? The answer is no, because NRLMOL orders the atoms once it processes the \sphinxstylestrong{CLUSTER} file.

\sphinxAtStartPar
However, remember that NRLMOL prints a file called \sphinxstylestrong{XMOL.DAT} which is basically an \sphinxstyleemphasis{xyz} file to visualize the molecule with Jmol{[}3{]} or any other molecular viewer, it contains a listing for the atoms calculated. The order of the atoms in this file is the same order followed by the DOS files.

\sphinxAtStartPar
Here is the contents of \sphinxstylestrong{XMOL.DAT} for our TCNE\sphinxhyphen{}Benzene:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
   \PYG{l+m+mi}{22}
\PYG{n}{TCNE}\PYG{o}{\PYGZhy{}}\PYG{n}{Benzene}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{0.00000}    \PYG{l+m+mf}{1.39877}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10067}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{0.00000}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.39877}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10067}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{1.21314}    \PYG{l+m+mf}{0.69957}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10094}
    \PYG{l+m+mi}{6}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.21314}    \PYG{l+m+mf}{0.69957}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10094}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{1.21314}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.69957}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10094}
    \PYG{l+m+mi}{6}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.21314}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.69957}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10094}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{0.00000}    \PYG{l+m+mf}{0.68629}    \PYG{l+m+mf}{1.54255}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{0.00000}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.68629}    \PYG{l+m+mf}{1.54255}
    \PYG{l+m+mi}{6}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.22092}    \PYG{l+m+mf}{1.43407}    \PYG{l+m+mf}{1.55350}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{1.22092}    \PYG{l+m+mf}{1.43407}    \PYG{l+m+mf}{1.55350}
    \PYG{l+m+mi}{6}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.22092}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.43407}    \PYG{l+m+mf}{1.55350}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{1.22092}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.43407}    \PYG{l+m+mf}{1.55350}
    \PYG{l+m+mi}{1}    \PYG{l+m+mf}{0.00000}    \PYG{l+m+mf}{2.49131}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10485}
    \PYG{l+m+mi}{1}    \PYG{l+m+mf}{0.00000}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.49131}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10485}
    \PYG{l+m+mi}{1}    \PYG{l+m+mf}{2.15872}    \PYG{l+m+mf}{1.24669}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10253}
    \PYG{l+m+mi}{1}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.15872}    \PYG{l+m+mf}{1.24669}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10253}
    \PYG{l+m+mi}{1}    \PYG{l+m+mf}{2.15872}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.24669}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10253}
    \PYG{l+m+mi}{1}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.15872}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.24669}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10253}
    \PYG{l+m+mi}{7}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.20482}    \PYG{l+m+mf}{2.05448}    \PYG{l+m+mf}{1.57451}
    \PYG{l+m+mi}{7}    \PYG{l+m+mf}{2.20482}    \PYG{l+m+mf}{2.05448}    \PYG{l+m+mf}{1.57451}
    \PYG{l+m+mi}{7}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.20482}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.05448}    \PYG{l+m+mf}{1.57451}
    \PYG{l+m+mi}{7}    \PYG{l+m+mf}{2.20482}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.05448}    \PYG{l+m+mf}{1.57451}

\end{sphinxVerbatim}

\sphinxAtStartPar
As you can see from this listing, the atoms do not have the same order as in the \sphinxstylestrong{CLUSTER} file. Usually, NRLMOL orders atoms by listing carbons first, then hydrogens and the the rest of the atoms (it’s the standard ordering for molecules in Chemistry).

\sphinxAtStartPar
From the listing, we now know that the first 12 DOS files correspond to the carbons, files 13\sphinxhyphen{}18 correspond to the hydrogens and files 19\sphinxhyphen{}22 correspond to the nitrogens. So now we have to plot the DOS files for each of the components and for the full complex, but in order to do so we are going to need membership files.


\subsection{Membership files}
\label{\detokenize{tutorials/ddos/density_of_states:membership-files}}
\sphinxAtStartPar
So far, we know that the \sphinxstylestrong{DOSO} files generated are for each atom in the system, and they follow the ordering from the \sphinxstylestrong{XMOL.DAT} file, so let’s put them side by side for clarity:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
   \PYG{l+m+mi}{22}
\PYG{n}{TCNE}\PYG{o}{\PYGZhy{}}\PYG{n}{Benzene}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{0.00000}    \PYG{l+m+mf}{1.39877}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10067} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO001}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{0.00000}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.39877}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10067} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO002}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{1.21314}    \PYG{l+m+mf}{0.69957}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10094} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO003}
    \PYG{l+m+mi}{6}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.21314}    \PYG{l+m+mf}{0.69957}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10094} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO004}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{1.21314}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.69957}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10094} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO005}
    \PYG{l+m+mi}{6}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.21314}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.69957}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10094} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO006}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{0.00000}    \PYG{l+m+mf}{0.68629}    \PYG{l+m+mf}{1.54255} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO007}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{0.00000}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.68629}    \PYG{l+m+mf}{1.54255} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO008}
    \PYG{l+m+mi}{6}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.22092}    \PYG{l+m+mf}{1.43407}    \PYG{l+m+mf}{1.55350} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO009}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{1.22092}    \PYG{l+m+mf}{1.43407}    \PYG{l+m+mf}{1.55350} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO010}
    \PYG{l+m+mi}{6}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.22092}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.43407}    \PYG{l+m+mf}{1.55350} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO011}
    \PYG{l+m+mi}{6}    \PYG{l+m+mf}{1.22092}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.43407}    \PYG{l+m+mf}{1.55350} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO012}
    \PYG{l+m+mi}{1}    \PYG{l+m+mf}{0.00000}    \PYG{l+m+mf}{2.49131}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10485} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO013}
    \PYG{l+m+mi}{1}    \PYG{l+m+mf}{0.00000}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.49131}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10485} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO014}
    \PYG{l+m+mi}{1}    \PYG{l+m+mf}{2.15872}    \PYG{l+m+mf}{1.24669}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10253} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO015}
    \PYG{l+m+mi}{1}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.15872}    \PYG{l+m+mf}{1.24669}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10253} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO016}
    \PYG{l+m+mi}{1}    \PYG{l+m+mf}{2.15872}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.24669}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10253} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO017}
    \PYG{l+m+mi}{1}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.15872}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.24669}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.10253} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO018}
    \PYG{l+m+mi}{7}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.20482}    \PYG{l+m+mf}{2.05448}    \PYG{l+m+mf}{1.57451} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO019}
    \PYG{l+m+mi}{7}    \PYG{l+m+mf}{2.20482}    \PYG{l+m+mf}{2.05448}    \PYG{l+m+mf}{1.57451} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO020}
    \PYG{l+m+mi}{7}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.20482}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.05448}    \PYG{l+m+mf}{1.57451} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO021}
    \PYG{l+m+mi}{7}    \PYG{l+m+mf}{2.20482}   \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.05448}    \PYG{l+m+mf}{1.57451} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZgt{}} \PYG{n}{DOSO022}
\end{sphinxVerbatim}

\sphinxAtStartPar
We can see from here that file \sphinxstylestrong{DOSO0007} corresponds to the seventh carbon atom, file \sphinxstylestrong{DOSO013} corresponds to the first hydrogen atom and so forth. As we previously stated, we need to generate three DOS plots: One for the full complex, one for the Benzene and one for the TCNE.

\sphinxAtStartPar
We clearly can see that the hydrogens belong to the Benzene and the nitrogens to the TCNE, but which carbons belong to the Benzene and which belong to the TCNE? we have no way of knowing this, so we need to open the \sphinxstylestrong{XMOL.DAT} file with Jmol to visualize the strucutre. Once you open it with Jmol, by positioning the cursor over a single atom it will tell you what number it is from the list, jot this number down and make a list for each atom of TCNE and benzene separately.

\sphinxAtStartPar
From this information you can create a membership list of the atom indexes for each of the substructures. For benzene, with the help of Jmol we know that carbon atoms 1\sphinxhyphen{}6 belong to the benzene and carbon atoms 7\sphinxhyphen{}12 belong to the TCNE. Therefore, the complete membership for benzene (fig. 2) is:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{1}
\PYG{l+m+mi}{2}
\PYG{l+m+mi}{3}
\PYG{l+m+mi}{4}
\PYG{l+m+mi}{5}
\PYG{l+m+mi}{6}
\PYG{l+m+mi}{13}
\PYG{l+m+mi}{14}
\PYG{l+m+mi}{15}
\PYG{l+m+mi}{16}
\PYG{l+m+mi}{17}
\PYG{l+m+mi}{18}

\end{sphinxVerbatim}

\sphinxAtStartPar
which are the indexes for the six carbon and the six hydrogen atoms.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[scale=0.3]{{frag1}.png}
\end{figure}

\sphinxAtStartPar
For TCNE (fig. 3) the membership is:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{7}
\PYG{l+m+mi}{8}
\PYG{l+m+mi}{9}
\PYG{l+m+mi}{10}
\PYG{l+m+mi}{11}
\PYG{l+m+mi}{12}
\PYG{l+m+mi}{19}
\PYG{l+m+mi}{20}
\PYG{l+m+mi}{21}
\PYG{l+m+mi}{22}

\end{sphinxVerbatim}

\sphinxAtStartPar
wich are the six carbon atoms and the four nitrogen atoms.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[scale=0.3]{{frag2}.png}
\end{figure}

\sphinxAtStartPar
We must now use this listings to create the membership files for plotting the DOS for each substructure, we only need to put in the first line of the membership file the total atoms for that membership. The membership file for benzene (let’s call it \sphinxstylestrong{benzene.mem}) is:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{12}
\PYG{l+m+mi}{1}
\PYG{l+m+mi}{2}
\PYG{l+m+mi}{3}
\PYG{l+m+mi}{4}
\PYG{l+m+mi}{5}
\PYG{l+m+mi}{6}
\PYG{l+m+mi}{13}
\PYG{l+m+mi}{14}
\PYG{l+m+mi}{15}
\PYG{l+m+mi}{16}
\PYG{l+m+mi}{17}
\PYG{l+m+mi}{18}
\end{sphinxVerbatim}

\sphinxAtStartPar
In general, the ordering of the atom indexes is not necessary, it’s just shown here for clarity.

\sphinxAtStartPar
Similarly the membership file for TCNE (let’s call it \sphinxstylestrong{tcne.mem}) is:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{10}
\PYG{l+m+mi}{7}
\PYG{l+m+mi}{8}
\PYG{l+m+mi}{9}
\PYG{l+m+mi}{10}
\PYG{l+m+mi}{11}
\PYG{l+m+mi}{12}
\PYG{l+m+mi}{19}
\PYG{l+m+mi}{20}
\PYG{l+m+mi}{21}
\PYG{l+m+mi}{22}
\end{sphinxVerbatim}

\sphinxAtStartPar
Additionally, we must create the membership file for the full complex, this is trivial, as it is just a listing of the indexes of all the atoms in the structure (let’s call it \sphinxstylestrong{total.mem}), you can even generate it automatically with the computational tool of your choice.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{22}
\PYG{l+m+mi}{1}
\PYG{l+m+mi}{2}
\PYG{l+m+mi}{3}
\PYG{l+m+mi}{4}
\PYG{l+m+mi}{5}
\PYG{l+m+mi}{6}
\PYG{l+m+mi}{7}
\PYG{l+m+mi}{8}
\PYG{l+m+mi}{9}
\PYG{l+m+mi}{10}
\PYG{l+m+mi}{11}
\PYG{l+m+mi}{12}
\PYG{l+m+mi}{13}
\PYG{l+m+mi}{14}
\PYG{l+m+mi}{15}
\PYG{l+m+mi}{16}
\PYG{l+m+mi}{17}
\PYG{l+m+mi}{18}
\PYG{l+m+mi}{19}
\PYG{l+m+mi}{20}
\PYG{l+m+mi}{21}
\PYG{l+m+mi}{22}
\end{sphinxVerbatim}

\sphinxAtStartPar
Again the ordering is not important as long as each atom is listed.

\sphinxAtStartPar
We can now use these three membership files to plot their corresponding density of states.


\subsection{Plotting}
\label{\detokenize{tutorials/ddos/density_of_states:plotting}}
\sphinxAtStartPar
To plot the membership files, we use the NRLMOL\_GUI program to do so. Set the project directory by selecting \sphinxstyleemphasis{Set Project Directory} from the \sphinxstyleemphasis{File} menu. This is the directory where you ran the calculation and that contains the DOS and other output files.  After this, select \sphinxstyleemphasis{Plot Density of States} from \sphinxstyleemphasis{Viewer} in the main menu (fig. 4).

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[scale=0.8]{{gui1}.png}
\end{figure}

\sphinxAtStartPar
This will open the dialog box for plotting density of states (fig. 5), from here:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Press the “Select File” button to select the membership file you want to plot.

\item {} 
\sphinxAtStartPar
Select the “Membership file” radio button to process the file as a membership file.

\item {} 
\sphinxAtStartPar
Select the “DOS file prefix” to select the prefix of your DOS files (in case they are not named (DOSO)

\item {} 
\sphinxAtStartPar
Type the titles and axis legends for the graph.

\item {} 
\sphinxAtStartPar
Click on the checkbox if you want the Fermi level to be plotted (the file \sphinxstylestrong{EVALUES} must be present in the project directory).

\item {} 
\sphinxAtStartPar
You can select to write a graphics file output, although you can do that by doing a right\sphinxhyphen{}click on the plot window, this second option is preferred since you can do some adjustments to the graph before saving.

\item {} 
\sphinxAtStartPar
The last check mark \sphinxstyleemphasis{Create data file} should be checked, and a file name given (only when plotting from a membership file), no extension is required as it will automatically add .dat to the file name.

\end{itemize}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[scale=0.8]{{dos_gui}.png}
\end{figure}

\sphinxAtStartPar
Why should a data file be created when plotting from a membership file? Well, the process goes as this: The program will take each of the DOS files for each atom, adds them together and puts it in a file for plotting, however; if you want to plot the data yourself with another program, you can use this data file for that purpose.
After you are finished, you should now have three final data files:
\begin{itemize}
\item {} 
\sphinxAtStartPar
benzene.dat a data file containing the DOS information for the benzene atoms generated from the benzene.mem file.

\item {} 
\sphinxAtStartPar
tcne.dat a data file containing the DOS information for the tcne atoms generated from the tcne.mem file.

\item {} 
\sphinxAtStartPar
total.dat a data file containing the DOS information for all the atoms generated from the total.mem file.

\end{itemize}

\sphinxAtStartPar
Let’s now use gnuplot{[}4{]} to generate the three plots in a single image from the data files.


\subsection{Gnuplot usage}
\label{\detokenize{tutorials/ddos/density_of_states:gnuplot-usage}}
\sphinxAtStartPar
To now join together the three data files, we need to setup a gnuplot script to process the data in each file and plot them. However, we also need one extra data file for the Fermi level.

\sphinxAtStartPar
We get the Fermi level from the \sphinxstylestrong{EVALUES} file: open the file and look for the line containing \sphinxstyleemphasis{FERMI LEVEL} and the number next to it, the number is however given in Hartrees, so you must convert it to electron\sphinxhyphen{}volt by multiplying it by 27.2116. You could have also got it from the GUI, if you requested to plot the Fermi level, this goes and reads it from the file and puts in a pop up window so you can jot it down.

\sphinxAtStartPar
For the TCNE\sphinxhyphen{}Benzene this value is: \sphinxhyphen{}0.206529774179560 so its corresponding value in eV is \sphinxhyphen{}5.620005603

\sphinxAtStartPar
So make a file called \sphinxstylestrong{fermi.dat} and put this two lines in it:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{5.620005603} \PYG{l+m+mi}{0}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{5.620005603} \PYG{l+m+mi}{70}
\end{sphinxVerbatim}

\sphinxAtStartPar
These are just two x,y pairs to be plotted. If you think about it, if the points are connected on a graph, they will generate a vertical line at the Fermi level (fig. 6).
We give the second point a big y value (70 in this case, it can be naything) to make shure we cover all the plot surface.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[scale=0.8]{{fermi1}.png}
\end{figure}

\sphinxAtStartPar
Now we are ready to configure the plotting script for gnuplot. This is just a text file (let’s call it \sphinxstylestrong{plot\_sample.p}) that conatins the following lines:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} This file will create a stacked plot for DOS}
\PYG{n+nb}{set} \PYG{n}{terminal} \PYG{n}{png} \PYG{n}{size} \PYG{l+m+mi}{1200}\PYG{p}{,}\PYG{l+m+mi}{900} \PYG{n}{linewidth} \PYG{l+m+mi}{3}
\PYG{n+nb}{set} \PYG{n}{output} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DOSplot\PYGZus{}sample.png}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n+nb}{set} \PYG{n}{linestyle} \PYG{l+m+mi}{1} \PYG{n}{linecolor} \PYG{n}{rgb} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n+nb}{set} \PYG{n}{linestyle} \PYG{l+m+mi}{2} \PYG{n}{linecolor} \PYG{n}{rgb} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n+nb}{set} \PYG{n}{multiplot} \PYG{n}{layout} \PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}
\PYG{c+c1}{\PYGZsh{} first plot top}
\PYG{n+nb}{set} \PYG{n}{bmargin} \PYG{n}{at} \PYG{n}{screen} \PYG{l+m+mf}{0.65}
\PYG{n+nb}{set} \PYG{n}{tmargin} \PYG{n}{at} \PYG{n}{screen} \PYG{l+m+mf}{0.95}
\PYG{n+nb}{set} \PYG{n}{xrange}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n+nb}{set} \PYG{n}{yrange}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{]}
\PYG{n+nb}{set} \PYG{n}{xtics} \PYG{n+nb}{format} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n+nb}{set} \PYG{n}{ytics} \PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{8}
\PYG{n}{plot} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tcne.dat}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{with} \PYG{n}{lines} \PYG{n}{linestyle} \PYG{l+m+mi}{1} \PYG{n}{notitle}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fermi.dat}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{with} \PYG{n}{lines} \PYG{n}{linestyle} \PYG{l+m+mi}{2} \PYG{n}{notitle}
\PYG{c+c1}{\PYGZsh{} Second plot middle}
\PYG{n+nb}{set} \PYG{n}{bmargin} \PYG{n}{at} \PYG{n}{screen} \PYG{l+m+mf}{0.35}
\PYG{n+nb}{set} \PYG{n}{tmargin} \PYG{n}{at} \PYG{n}{screen} \PYG{l+m+mf}{0.65}
\PYG{n}{plot} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{benzene.dat}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{with} \PYG{n}{lines} \PYG{n}{linestyle} \PYG{l+m+mi}{1} \PYG{n}{notitle}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fermi.dat}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{with} \PYG{n}{lines} \PYG{n}{linestyle} \PYG{l+m+mi}{2} \PYG{n}{notitle}
\PYG{c+c1}{\PYGZsh{} Third plot}
\PYG{n+nb}{set} \PYG{n}{bmargin} \PYG{n}{at} \PYG{n}{screen} \PYG{l+m+mf}{0.05}
\PYG{n+nb}{set} \PYG{n}{tmargin} \PYG{n}{at} \PYG{n}{screen} \PYG{l+m+mf}{0.35}
\PYG{n+nb}{set} \PYG{n}{xtics} \PYG{n+nb}{format} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZpc{}g}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{plot} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{all.dat}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{with} \PYG{n}{lines} \PYG{n}{linestyle} \PYG{l+m+mi}{1} \PYG{n}{notitle}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fermi.dat}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{with} \PYG{n}{lines} \PYG{n}{linestyle} \PYG{l+m+mi}{2} \PYG{n}{notitle}
\PYG{n}{unset} \PYG{n}{multiplot}

\end{sphinxVerbatim}

\sphinxAtStartPar
Lines that begin with \sphinxstyleemphasis{\#} are comments and are thus ignored. The configurable options are:
\begin{itemize}
\item {} 
\sphinxAtStartPar
We set a terminal output of png, this means we will generate a \sphinxstyleemphasis{.png} graphic file

\item {} 
\sphinxAtStartPar
The requested linewidth is 3 is needed for publication qualitiy graphs.

\item {} 
\sphinxAtStartPar
The \sphinxstyleemphasis{set output} line specifies the file name of the generated file.

\item {} 
\sphinxAtStartPar
Two linestyles are defined, which specify the line colors for the DOS data and Fermi level respectively.

\item {} 
\sphinxAtStartPar
We remove unnecessary data by adjusting the x range (usually on the unoccupied states) to the left of the Fermi level (set xrange{[}\sphinxhyphen{}12:0{]}).

\item {} 
\sphinxAtStartPar
We adjust the y range so all plots have the same height (set yrange{[}0:10{]}).

\item {} 
\sphinxAtStartPar
We remove any number on the x axis until the last plot with: set xtics format ‘ ‘

\item {} 
\sphinxAtStartPar
The set ytics 0,2,8 means that the y range will be printed from 0 to 8 in increments of 2.

\item {} 
\sphinxAtStartPar
You can change the order of the plots by specifying the name of the \sphinxstyleemphasis{.dat} file in each section (just don’t forget to include the \sphinxstyleemphasis{fermi.dat} file).

\end{itemize}

\sphinxAtStartPar
Once you set this up, run the script through gnuplot with the folowing command (in Linux, other platforms are untested):

\sphinxAtStartPar
\sphinxstyleemphasis{gnuplot plot\_sample.p}

\sphinxAtStartPar
You may need to run this command several times, while adjusting the values in the gnuplot script.

\sphinxAtStartPar
Once you get plot you’re confortable with (fig. 7), you still need to include the Axis labels as well as the descriptions of the individual plots (what part of the molecule each section represents), this can be done with any graphical editor (in the lab I usually use the GIMP{[}5{]} package, but it can be done with a presentation editor) to edit the png file (fig. 8).

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[scale=0.4]{{DOSplot_sample}.png}
\end{figure}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[scale=0.4]{{DOSplot_samplef}.png}
\end{figure}


\subsection{Bibliography}
\label{\detokenize{tutorials/ddos/density_of_states:bibliography}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
David S. Sholll \&  Janice A. Steckel, \sphinxstyleemphasis{Density Functional Theory: A practical Introduction}, Wiley (2009).

\item {} 
\sphinxAtStartPar
Ricahrd M. Martin, \sphinxstyleemphasis{Electronic Structure, Basic Theory and Practical Methods}, Cambridge University Press (2013).

\item {} 
\sphinxAtStartPar
Jmol: An open\sphinxhyphen{}source Java viewer for chemical structures in 3D. \sphinxurl{http://www.jmol.org}

\item {} 
\sphinxAtStartPar
gnuplot: A portable command\sphinxhyphen{}line driven graphing utility. \sphinxurl{http://www.gnuplot.info}

\item {} 
\sphinxAtStartPar
GIMP: The GNU Image Manipulation Program. \sphinxurl{http://www.gimp.org}

\end{enumerate}

\sphinxstepscope


\chapter{Getting more information about FLOSIC}
\label{\detokenize{docs/nrlmolfaq:getting-more-information-about-flosic}}\label{\detokenize{docs/nrlmolfaq:nrlmolfaq}}\label{\detokenize{docs/nrlmolfaq::doc}}\begin{quote}
\begin{description}
\sphinxlineitem{Questions about the FLOSIC code or its use can be directed to}\begin{itemize}
\item {} 
\sphinxAtStartPar
Tunna Baruah        (UTEP), \sphinxhref{mailto:tbaruah@utep.edu}{tbaruah@utep.edu}

\item {} 
\sphinxAtStartPar
Rajendra R. Zope    (UTEP), \sphinxhref{mailto:rzope@utep.edu}{rzope@utep.edu}

\item {} 
\sphinxAtStartPar
Koblar Alan Jackson (CMU), \sphinxhref{mailto:jacks1ka@cmich.edu}{jacks1ka@cmich.edu}

\end{itemize}

\end{description}

\sphinxAtStartPar
or write to the FLOSIC mail server \sphinxhref{mailto:electronic\_structure\_lab@listserv.utep.edu}{electronic\_structure\_lab@listserv.utep.edu}.

\sphinxAtStartPar
Some FAQs are listed below.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} \begin{description}
\sphinxlineitem{What convergence criteria should be considered for the FOD optimization?}
\sphinxAtStartPar
In general, you want to make sure that your total energy is converged within your given SCF tolerance (like in a standard DFT calculation) and
that the largest FOD force is at least smaller than 5E\sphinxhyphen{}4 Ha/Bohr.

\end{description}

\item {} \begin{description}
\sphinxlineitem{How can I start a spin\sphinxhyphen{}polarized/ spin\sphinxhyphen{}unrestricted calculation?}
\sphinxAtStartPar
For a spin\sphinxhyphen{}unrestricted calculation, you need to make sure that your underlying DFT density is spin\sphinxhyphen{}unrestricted as well.
If your system has a permanent spin polarization (i.e. the number of up and down electrons is different), the calculation
will always be spin\sphinxhyphen{}unrestricted.
In the case of a total spin of S = 0 (i.e. same number of up and down electrons), the code automatically carries out
a spin\sphinxhyphen{}restricted calculation. To switch to a spin\sphinxhyphen{}unrestricted setup (i.e. having individual sets of up and down FODs in the FRMORB file), set the
SPNPOLV option in NRLMOL\_INPUT.DAT to Y.

\end{description}

\item {} \begin{description}
\sphinxlineitem{Is it possible to force antiferromagntic spin ordering in some atoms?}
\sphinxAtStartPar
Yes, you can specify atoms to have a preference for spin\sphinxhyphen{}up density, spin\sphinxhyphen{}down density or unpolarized density. The specifications needs to be made in the SYMBOL file. Here is an example :

\begin{DUlineblock}{0em}
\item[] ALL\sphinxhyphen{}MAN001 =        2.137000       \sphinxhyphen{}0.350000        0.003300 SUP
\item[] ALL\sphinxhyphen{}MAN001 =        3.456900       \sphinxhyphen{}2.109300        0.093100 SDN
\item[] ALL\sphinxhyphen{}CAR001 =        2.720100       \sphinxhyphen{}2.490500        0.106000 UPO
\end{DUlineblock}

\sphinxAtStartPar
SUP, SDN and UPO signify spin up, spin down and unpolarized atoms. The default choice is UPO.
Note that these are starting values for the atoms. After SCF, the density can be different than what has been initialized.

\end{description}

\end{enumerate}
\end{quote}



\renewcommand{\indexname}{Index}
\printindex
\end{document}