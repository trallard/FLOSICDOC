<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Accessing and compiling the code &mdash; NRLMOL  2020 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Support" href="Support.html" />
    <link rel="prev" title="Prerequisites" href="Prerequisites.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #4372c4" >

          
          
          <a href="../../main.html">
            
              <img src="../../_static/log.jpeg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Introduction and Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="toc.html">Installing FLOSIC</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Prerequisites.html">Prerequisites</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Accessing and compiling the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="Support.html">Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Reference/toc.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Reference/files.html">Input and Output Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Reference/functionals.html">Exchange correlation functionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Reference/isymgen.html">Basis sets: the ISYMGEN file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Reference/mesh.html">FLOSIC Mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Reference/nrlmolinputdat.html">Controlling a calculation: the NRLMOL_INPUT.DAT file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../setupcal.html">Quick start guide to running a FLOSIC calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/tuttoc.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/dtutorials/tutorial1.html">Tutorial 1: Molecular geometry optimization at the DFT level</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/dtutorials/tutorial2.html">Tutorial 2: a FLOSIC calculation for H2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/dtutorials/T3-FOD_opt.html">Tutorial 3:  FOD optimization of a water molecule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/ddos/density_of_states.html">Plotting density of states using NRLMOL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/ddos/density_of_states.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/ddos/density_of_states.html#setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/ddos/density_of_states.html#results">Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/ddos/density_of_states.html#membership-files">Membership files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/ddos/density_of_states.html#plotting">Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/ddos/density_of_states.html#gnuplot-usage">Gnuplot usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/ddos/density_of_states.html#bibliography">Bibliography</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../nrlmolfaq.html">Getting more information about FLOSIC</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #4372c4" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../main.html">NRLMOL </a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../main.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="toc.html">Installing FLOSIC</a></li>
      <li class="breadcrumb-item active">Accessing and compiling the code</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/docs/install/Build.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="accessing-and-compiling-the-code">
<h1>Accessing and compiling the code<a class="headerlink" href="#accessing-and-compiling-the-code" title="Permalink to this heading"></a></h1>
<p>The code is accessible from a GitHub repository. To download the latest version, use a git command as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/FLOSIC/PublicRelease_2020.git
</pre></div>
</div>
<p>Once you have obtained the code from the repository, go to the directory containing the source files.  You will
need to edit three blocks of lines in the makefile to suit your needs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have not modified a Makefile before - no worries!
You only have to switch a few variables.</p>
</div>
<p><strong>First block: parallel or serial</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># set Y or N</span>
<span class="c1"># Parallel compilation</span>
<span class="nv">MPI</span><span class="o">=</span>Y
<span class="c1"># Group calculation</span>
<span class="nv">GROUP</span><span class="o">=</span>N
</pre></div>
</div>
<p>In this block, the user specifies whether the compilation will be for a parallel (MPI=Y) or serial (MPI=N) version of the code.
When using a parallel version (MPI=Y), the user can choose to use a multi-level parallel scheme by setting GROUP=Y.
This parallelizes over the orbitals in calculating SIC potentials, and also over the grid points.
This option can deliver a greater speed up than the single-level parallel scheme, but it is not recommended for new users.</p>
<p>When GROUP=Y, the user should edit the “igroup” file in the run directory.  This file should contain an integer that is
an even divisor of the number of orbitals. For example, for 100 orbitals, igroup might be 10 or 20, but not 15.</p>
<p><strong>Second block: compiler choices</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># COMPILERS</span>
<span class="nv">CC</span> <span class="o">=</span> gcc
<span class="nv">FC</span> <span class="o">=</span> mpif90
<span class="nv">FFF</span> <span class="o">=</span> mpif90
<span class="c1"># COMPILER FLAGS</span>
<span class="nv">CFLAGS</span> <span class="o">=</span> -O3 -mcmodel<span class="o">=</span>medium
<span class="nv">FFLAGS</span> <span class="o">=</span> -O3 -mcmodel<span class="o">=</span>medium
<span class="nv">LFLAGS</span> <span class="o">=</span> -O3 -mcmodel<span class="o">=</span>medium
</pre></div>
</div>
<p>The second block is to specify the compilers and their flags used during the compilation. A number of routines require static allocation of arrays. The code needs to be compiled for appropriate array sizes for the system under study and these static parameters are listed in the file called PARAMA2 (<em>vide infra</em>)</p>
<p>An example of the compilers used for NERSC is below.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CC</span> <span class="o">=</span> cc
<span class="nv">FC</span> <span class="o">=</span> ftn
<span class="nv">FFF</span> <span class="o">=</span> ftn
</pre></div>
</div>
<p><strong>Third block: linking options</strong></p>
<p># Linking options</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">$(</span>FFF<span class="k">)</span> <span class="k">$(</span>LFLAGS<span class="k">)</span> <span class="k">$(</span>OBJ<span class="k">)</span> -o <span class="k">$(</span>BIN<span class="k">)</span> -llapack -lblas <span class="k">$(</span>LIBS<span class="k">)</span>
</pre></div>
</div>
<p>This block specifies the libraries used for linking, where it is recommended to use optimized BLAS and LPACK libraries if they are available on your platform to achieve the best performance.</p>
<p>Edit PARAMA2 for static parameters :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>parameter</p></th>
<th class="head"><p>brief  explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>MAX_PTS</em></p></td>
<td><p>maximum size of integration grid</p></td>
</tr>
<tr class="row-odd"><td><p><em>MX_SPH</em></p></td>
<td><p>needed to generate the integration mesh</p></td>
</tr>
<tr class="row-even"><td><p><em>MAXUNSYM</em></p></td>
<td><p>maximum number of orbitals for an atomic basis</p></td>
</tr>
<tr class="row-odd"><td><p><em>NDH</em></p></td>
<td><p>maximum total basis set size</p></td>
</tr>
<tr class="row-even"><td><p><em>NDH_TOT</em></p></td>
<td><p>maximum number of Hamiltonian matrix elements</p></td>
</tr>
<tr class="row-odd"><td><p><em>MAX_OCC</em></p></td>
<td><p>maximum number of occupied states</p></td>
</tr>
<tr class="row-even"><td><p><em>MX_GRP</em></p></td>
<td><p>maximum size of symmetry group</p></td>
</tr>
</tbody>
</table>
<p>An example for serial compilation on a laptop (in this case a mac) is shown below.</p>
<p><strong>First block:</strong> Compile the serial version</p>
<p>MPI=N</p>
<p>GROUP=N</p>
<p><strong>Second block:</strong> use gcc and gfortran compilers</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#COMPILERS</span>
<span class="nv">CC</span> <span class="o">=</span> gcc
<span class="nv">FC</span> <span class="o">=</span> gfortran
<span class="nv">FFF</span> <span class="o">=</span> gfortran

<span class="c1">#COMPILER FLAGS</span>
<span class="nv">CFLAGS</span> <span class="o">=</span> -O3
<span class="nv">FFLAGS</span> <span class="o">=</span> -O3
<span class="nv">LFLAGS</span> <span class="o">=</span> -O3
</pre></div>
</div>
<p><strong>Third block:</strong> Use the linking options under Fedora (Quantum/Luis local)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">$(</span>FFF<span class="k">)</span> <span class="k">$(</span>LFLAGS<span class="k">)</span> <span class="k">$(</span>OBJ<span class="k">)</span> -o <span class="k">$(</span>BIN<span class="k">)</span> <span class="k">$(</span>PCM_LIBS<span class="k">)</span> <span class="k">$(</span>EFP_LIB<span class="k">)</span> -llapack -lblas <span class="k">$(</span>LIBS<span class="k">)</span>
</pre></div>
</div>
<p>Use the <em>make</em> command on the command line to compile FLOSIC. If the compilation was successful, an executable file titled <strong>nrlmol_exe</strong> will be created.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Prerequisites.html" class="btn btn-neutral float-left" title="Prerequisites" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Support.html" class="btn btn-neutral float-right" title="Support" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023,   NRLMOL users .
      <span class="lastupdated">Last updated on Feb 26, 2023.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>