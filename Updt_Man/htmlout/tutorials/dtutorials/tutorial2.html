
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Tutorial 2: a FLOSIC calculation for H2 &#8212; NRLMOL  2020 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tutorial 3: FOD optimization of a water molecule" href="T3-FOD_opt.html" />
    <link rel="prev" title="Tutorial 1: Molecular geometry optimization at the DFT level" href="tutorial1.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="T3-FOD_opt.html" title="Tutorial 3: FOD optimization of a water molecule"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial1.html" title="Tutorial 1: Molecular geometry optimization at the DFT level"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../main.html">NRLMOL  2020 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../tutrlstoc.html" accesskey="U">Tutorials</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Tutorial 2: a FLOSIC calculation for H2</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="tutorial-2-a-flosic-calculation-for-h2">
<h1>Tutorial 2: a FLOSIC calculation for H2<a class="headerlink" href="#tutorial-2-a-flosic-calculation-for-h2" title="Permalink to this headline">Â¶</a></h1>
<p>In this tutorial we will learn to do a simple FLOSIC calculation.
We choose the case of the H2 molecule.
Again, as a reminder the <strong>CLUSTER</strong> file is the main input file of FLOSIC. It contains
the minimal information to set up the calculation. See below the CLUSTER file for the hydrogen molecule.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GGA</span><span class="o">-</span><span class="n">PBE</span><span class="o">*</span><span class="n">GGA</span><span class="o">-</span><span class="n">PBE</span>            <span class="c1"># Exchange-correlation parametrization</span>
<span class="n">NONE</span>                       <span class="c1"># Point group of system</span>
<span class="mi">2</span>                          <span class="c1"># No. of atoms</span>
<span class="mf">0.0</span> <span class="mf">0.0</span>  <span class="mf">0.5</span>    <span class="mi">1</span>  <span class="n">ALL</span>    <span class="c1"># x,y,z coordinates, Atomic number, ALL means all electron</span>
<span class="mf">0.0</span> <span class="mf">0.0</span> <span class="o">-</span><span class="mf">0.5</span>    <span class="mi">1</span>  <span class="n">ALL</span>    <span class="c1"># x,y,z coordinates, Atomic number, ALL means all electron</span>
<span class="mf">0.0</span> <span class="mf">0.000</span>                 <span class="c1"># Charge and Moment</span>

</pre></div>
</div>
<p>We will now describe the input structure of this file.
The first line is <strong>GGA-PBE*GGA-PBE</strong>. It specifies that the electron-electron exchange and correlation interactions in the
systems are modeled within the generalized gradient approximation (GGA) using the Perdew-Burke-Ernzerhof
(PBE) parametrization. This is the default functional used in FLOSIC. A few other functionals are also
available.</p>
<p>The second line is <strong>NONE</strong>. It refers to point group symmetry. NONE means that there is no symmetry.
To use symmetry point groups from a GRPPMAT file, replace this with <strong>GRP</strong>. A few selected symmetry groups such as Ih, Td, Th, C3V
etc. can also be provided here. In this case the GRPMAT corresponding to specified point group will be
automatically generated by NRLMOL. Even though the H2 molecule possesses symmetry we will perform the
calculation without symmetry, so keep the <strong>NONE</strong> line as it is. A GRPMAT file will be created automatically and will contain the
identity matrix only.</p>
<p>The third line specifies the number of inequivalent atoms in calculations. Since we are not making use of point group
symmetry, the number of inequivalent atoms is the same as total number of atoms, which is 2 in this case.</p>
<p>The lines following the third line contain information for each of the inequivalent atoms.
The first three numbers are the cartesian positions in atomic units, its atomic number, and
string ALL. In this example, we have placed one hydrogen atom at (0,0,Z) and the second one at (0,0,-Z).
You can put the atoms anywhere. Atomic positions should be given in atomic units, Bohr.
Following the xyz coordinates is the atomic number. The example listed is for hydrogen
whose atomic number is 1. The string ALL signifies that the calculations are to be performed
at the all-electron level. It is also possible to use pseudopotentials. Only the BHS pseudopotentials
are hardwired into the code. It is also possible to use user-supplied (numerical) pseudopotentials also, but
requires more work and is not recommended for beginners.</p>
<p>The last line in the example has two fields. The first field is 0.0 which means perform the calculation
for the neutral molecule. If it is 1 then the calculations will be performed for singly charged
cation of the system. The next field, which is 0 in this example, corresponds to the number of unpaired
electrons in the system. There are no unpaired electrons in this example.
Lines after Charge and Moment line are ignored.</p>
<p>A file called <strong>FRMORB</strong> is also required, which contains the FOD positions. An example FRMORB file for H2 is shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mf">0.00</span> <span class="mf">0.00</span> <span class="mf">0.00</span>
<span class="mf">0.00</span> <span class="mf">0.00</span> <span class="mf">0.00</span>
</pre></div>
</div>
<p>The first line contains two fields. The first is the number of spin up FODs (N) and the second is the number of spin down FODs (M).
For H2, we only have one electron in each spin channel. The up FOD coordinates (x,y,z) are the following N lines.
After that is the coordinates (x,y,z) of the M spin down FODs</p>
<p>To avoid optimizing atomic geometries, change the CALCTYPE field in NRLMOL_INPUT.DAT from LBFGS to SCF-ONLY. This is recommended for FLOSIC
calculations when the FODs are being optimized.</p>
<p>Now, copy the example input files called CLUSTER and FRMORB into an empty directory. Run the calculation for the H2 molecule
using the following command at the prompt.</p>
<blockquote>
<div><p>$ <strong>PATH_TO_FLOSIC/nrlmol_exe &gt; print</strong></p>
</div></blockquote>
<p>Now, browse through the file SUMMARY and look at the energies printed at each iteration of the SCF cycle. You should see that the minimum
total energy is reached at self-consistency.
Also, look at the EVALUES file in which Kohn-Sham eigenvalues and occupation numbers are printed.</p>
<p>The FOD forces are displayed in the records file, which has the same format as FRMORB, followed by the FOD forces in the same order.</p>
<p>The fande.out file contains the iteration, total DFT+SIC energy, square root of the sum of the squares of the FOD forces, and the max FOD force.
When optimizing FODs, this is a good file to check for the convergence of FOD forces.</p>
<p>After completing a self-consistent calculation, the FOD forces are used in a gradient optimization scheme to update the FOD positions.
These are written into the FRMORB file.  Re-running the code will cause another self-consistent calculation to be performed, using the
updated FOD positions.  A new total energy and new FOD forces will be calculated, and the FOD positions will again be updated.
Repeating this process will result in the optimization of the FOD positions.  Convergence can be gauged by the size by the largest FOD
force.  When this drops below a chosen convergence criterion, the FODs are optimized.</p>
<p>To further optimize FODs, repeatedly run the code until the calculation is optimized to your criterion.
A simple iterative loop can help with this process.</p>
<p>For the example of H2, there is only one FOD of each spin. Placing the FODs at any position in space
for such a case will give the same energy and the force on the FOD will therefore be zero.</p>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="tutorial1.html"
                          title="previous chapter">Tutorial 1: Molecular geometry optimization at the DFT level</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="T3-FOD_opt.html"
                          title="next chapter">Tutorial 3:  FOD optimization of a water molecule</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/tutorials/dtutorials/tutorial2.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="T3-FOD_opt.html" title="Tutorial 3: FOD optimization of a water molecule"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial1.html" title="Tutorial 1: Molecular geometry optimization at the DFT level"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../main.html">NRLMOL  2020 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../tutrlstoc.html" >Tutorials</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Tutorial 2: a FLOSIC calculation for H2</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022,   NRLMOL users .
    </div>
  </body>
</html>