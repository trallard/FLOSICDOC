
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>FLOSIC Mesh &#8212; NRLMOL  2020 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Input and Output Files" href="files.html" />
    <link rel="prev" title="Controlling a calculation: the NRLMOL_INPUT.DAT file" href="nrlmolinputdat.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="files.html" title="Input and Output Files"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nrlmolinputdat.html" title="Controlling a calculation: the NRLMOL_INPUT.DAT file"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../main.html">NRLMOL  2020 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FLOSIC Mesh</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="flosic-mesh">
<span id="mesh"></span><h1>FLOSIC Mesh<a class="headerlink" href="#flosic-mesh" title="Permalink to this headline">Â¶</a></h1>
<p>In FLOSIC, the mesh is generated by specifying the accuracy of various integrals. The mesh is refined until the specified accuracy of
the integrals is accomplished. In this sense, the mesh is variational. For further details about how the mesh is generated please refer to the paper by Pederson and Jackson(Phys. Rev. B 41, 7453).
There are two types of meshes used in the calculation. One is the radial mesh used for calculations within the
atomic spheres and the other is the interstitial mesh (mesh between atomic spheres). The defaults for these are 1.E-06.
The mesh parameters are stored in the MESHDAT file. The default MESHDAT file for a DFT level calculation will look like the one below.
It is possible to change the default mesh.
The parameters used in creating the mesh are listed in the MESHDAT file. The default MESHDAT file for a DFA calculation is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">F</span>                                                                     <span class="n">line</span> <span class="mi">1</span>
  <span class="mf">0.10000E-06</span>   <span class="mf">1.2000</span>                                                     <span class="n">line</span> <span class="mi">2</span>
   <span class="mi">6</span>                                                                       <span class="n">line</span> <span class="mi">3</span>
  <span class="mf">0.20000</span>      <span class="mf">0.40000</span>      <span class="mf">0.60000</span>       <span class="mf">1.0000</span>       <span class="mf">1.6000</span>              <span class="n">line</span> <span class="mi">4</span>
   <span class="mi">4</span>                                                                       <span class="n">line</span> <span class="mi">5</span>
   <span class="mf">2.1000</span>       <span class="mf">10.100</span>       <span class="mf">18.100</span>                                        <span class="n">line</span> <span class="mi">6</span>
   <span class="mi">2</span>   <span class="mi">1</span>   <span class="mi">3</span>   <span class="mi">5</span>   <span class="mi">5</span>   <span class="mi">7</span>   <span class="mi">9</span>  <span class="mi">11</span>  <span class="mi">19</span>  <span class="mi">21</span>                                   <span class="n">line</span> <span class="mi">7</span>
   <span class="mi">4</span>   <span class="mi">1</span>   <span class="mi">3</span>   <span class="mi">5</span>   <span class="mi">5</span>   <span class="mi">7</span>   <span class="mi">9</span>  <span class="mi">11</span>  <span class="mi">19</span>  <span class="mi">21</span>                                   <span class="n">line</span> <span class="mi">8</span>
   <span class="mi">4</span>   <span class="mi">1</span>   <span class="mi">3</span>   <span class="mi">6</span>   <span class="mi">5</span>   <span class="mi">7</span>   <span class="mi">9</span>  <span class="mi">11</span>  <span class="mi">19</span>  <span class="mi">21</span>                                   <span class="n">line</span> <span class="mi">9</span>
   <span class="mi">6</span>   <span class="mi">1</span>   <span class="mi">3</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">7</span>   <span class="mi">9</span>  <span class="mi">11</span>  <span class="mi">19</span>  <span class="mi">21</span>                                   <span class="n">line</span> <span class="mi">10</span>
  <span class="mf">0.10000E-06</span>   <span class="mf">1.2000</span>                                                     <span class="n">line</span> <span class="mi">11</span>
   <span class="mf">2.0000</span>       <span class="mi">8</span>                                                          <span class="n">line</span> <span class="mi">12</span>
   <span class="mf">2.0000</span>                                                                  <span class="n">line</span> <span class="mi">13</span>

</pre></div>
</div>
<p>The default MESHDAT file for a FLOSIC calculations is shown below:</p>
<p>As noted above are two types of meshes used in the calculation. One is the radial mesh use for calculations within atomic spheres and the other is the interstitial mesh.</p>
<p>Line 1:</p>
<p>Line 2: The numbers in this line pertain to the radial mesh. The radial mesh is constructed to give integrations involving various Gaussians from short to long range. The small number is the error allowed in integration by the mesh. The second number, 1.2, separates the exponentials of the Gaussians which are tested i.e. the n+1st exponential is 1.2 times nth exponent. Decreasing the error tolerance will result in increase in number of mesh points and better integrals.</p>
<p>Line 3: The atomic sphere is divided into different concentric regions with different numbers of mesh points. The number of such radial zones is written in line 3.</p>
<p>Line 4: The outer radii of the radial zones.</p>
<p>Line 5: The mesh may be different for different atoms. For example, heavier atoms generally need denser radial meshes
near the nucleus. Hence the periodic table (upto Z=56) is divided in 4 types of meshes.</p>
<p>Line 6: This line shows the 4 types of meshes for atoms : first one for Z&lt;2.1, second one for Z&lt;10.1 and third on for Z&lt;18.1 and the last one for Z&gt;18.</p>
<p>Line 7,8,9,10: These four lines contain the parameters for each type of atomic mesh. The numbers are</p>
<p><strong>NPATS, NPIST, NTHET, NPHI, LMAX</strong> FOR EACH RADIAL ZONE</p>
<p><strong>NPATS</strong> :</p>
<p><strong>NPIST, NTHET, NPHI</strong> : Before creating the mesh, the space is divided into boxes such that each atom is contained in one box. Then a sphere around the atom is assumed and the radial mesh is created. The space at the box corners between the atomic sphere and the rectangular box is divided in a different mesh. The parameters NPIST, NTHET and NPHI correspond to the mesh at the box corners.</p>
<p><strong>LMAX</strong> : LMAX for the each radial zone. This mesh will integrate a function of the type r lmax exp(-. r2) within the given error limit in this region. Increasing LMAX results in a more refined mesh.</p>
<p>Line 11 : This line contains the same parameters as line 2 but for the interstitial mesh. Decreasing the error limit results in more accurate integrals in the interstitial region.</p>
<p>Line 12: Cutfac, mx1d</p>
<p><strong>CUTFAC</strong>: If a box transforms into itself due to symmetry, it will be split if it is larger than cutfac times the distance to the closest atom.</p>
<p><strong>MX1D</strong>: max. number of points in a one-dimensional interstitial partition</p>
<p>Line 13: Splrat</p>
<p><strong>SPLRAT</strong>: largest allowed ratio for: the size of an atomic box divided by the distance of another atom to the box boundary</p>
<blockquote>
<div><p>The user can set these parameters to exercise control over the quality of calculation. For example the default mesh in FLOSIC code has been tested for FLO-SIC-LSDA calculations and is capable of providing accurate results, while the mesh required in a DFT-LDA calculation does not have to have many mesh points as in a FLO-SIC-LDA calculation. Above values are default. <em>Warning</em> When taking energy differences and comparing the energies it is advisable to ensure that same quality of mesh was used in all pertaining calculations.</p>
</div></blockquote>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="nrlmolinputdat.html"
                          title="previous chapter">Controlling a calculation: the NRLMOL_INPUT.DAT file</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="files.html"
                          title="next chapter">Input and Output Files</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/docs/mesh.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="files.html" title="Input and Output Files"
             >next</a> |</li>
        <li class="right" >
          <a href="nrlmolinputdat.html" title="Controlling a calculation: the NRLMOL_INPUT.DAT file"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../main.html">NRLMOL  2020 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FLOSIC Mesh</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022,   NRLMOL users .
    </div>
  </body>
</html>