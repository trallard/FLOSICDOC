<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Plotting density of states using NRLMOL &mdash; NRLMOL  2020 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Getting more information about FLOSIC" href="../../docs/nrlmolfaq.html" />
    <link rel="prev" title="Tutorial 3: FOD optimization of a water molecule" href="../dtutorials/T3-FOD_opt.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            NRLMOL 
              <img src="../../_static/log.jpeg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/Reference/toc.html">Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tuttoc.html">User Guide and Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../setupcal.html">Quick start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dtutorials/tutorial1.html">Tutorial 1: Molecular geometry optimization at the DFT level</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dtutorials/tutorial2.html">Tutorial 2: a FLOSIC calculation for H2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dtutorials/T3-FOD_opt.html">Tutorial 3:  FOD optimization of a water molecule</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plotting density of states using NRLMOL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results">Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#membership-files">Membership files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting">Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gnuplot-usage">Gnuplot usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bibliography">Bibliography</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/nrlmolfaq.html">Getting more information about FLOSIC</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NRLMOL </a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../tuttoc.html">User Guide and Tutorials</a></li>
      <li class="breadcrumb-item active">Plotting density of states using NRLMOL</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorials/ddos/density_of_states.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="plotting-density-of-states-using-nrlmol">
<h1>Plotting density of states using NRLMOL<a class="headerlink" href="#plotting-density-of-states-using-nrlmol" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>Once you start using NRLMOL, eventually you will need to plot the density of states for the system that you are running. The process can get a little messy so this guide should solve out some doubts.</p>
<p>First of, what are densities of states?</p>
<p>Basically, it’s the number of electronic states at a given energy, and is one of the most important quantities to describe the electronic state of a structure [1].</p>
<p>They are calculated via this:
<span class="math notranslate nohighlight">\(\rho(E)=\frac{1}{N_k}\sum\limits_{i,k}\delta(\epsilon_{i,k}-E)\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\rho(E)\)</span> is the number of independent-particles states per unit energy, <span class="math notranslate nohighlight">\(\epsilon_{i,k}\)</span> denotes the energy of an electron [2].</p>
<p>The plots themselves are more qualitative than quantitative, since they tell us the localization of states within an energy interval, but the exact number of states for a given energy is rather unimportant. For our purposes (photovoltaics), we are interested mailnly in checking that the last occupied state (that is, the HOMO) is localized in the donor, and that the first unoccupied state (LUMO) resides in the acceptor.</p>
</section>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading"></a></h2>
<p>So let’s do this by example. Let us do the calculation for the density of states for a system we have used previously, Tetracyanoethylene Benzene, or TCNE-Benzene. This is compound molecule made up of two components: the TCNE and Benzene, here the TCNE is in front and the benzene is in the backgound (Fig. 1).</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/tcne_img.png"><img alt="TCNE-Benzene complex." src="../../_images/tcne_img.png" style="width: 211.20000000000002px; height: 197.60000000000002px;" /></a>
</figure>
<p>The <strong>CLUSTER</strong> file to run the calculation of this structure is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GGA</span><span class="o">-</span><span class="n">PBE</span><span class="o">*</span><span class="n">GGA</span><span class="o">-</span><span class="n">PBE</span>
<span class="n">GRP</span>
          <span class="mi">22</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">inequivalent</span> <span class="n">atoms</span>
       <span class="mf">0.0000</span>      <span class="mf">4.7079</span>     <span class="o">-</span><span class="mf">3.9776</span>   <span class="mi">1</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">0.0000</span>     <span class="o">-</span><span class="mf">4.7079</span>     <span class="o">-</span><span class="mf">3.9776</span>   <span class="mi">1</span> <span class="n">ALL</span> <span class="n">UPO</span> 
       <span class="mf">4.0794</span>      <span class="mf">2.3559</span>     <span class="o">-</span><span class="mf">3.9732</span>   <span class="mi">1</span> <span class="n">ALL</span> <span class="n">UPO</span> 
      <span class="o">-</span><span class="mf">4.0794</span>      <span class="mf">2.3559</span>     <span class="o">-</span><span class="mf">3.9732</span>   <span class="mi">1</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">4.0794</span>     <span class="o">-</span><span class="mf">2.3559</span>     <span class="o">-</span><span class="mf">3.9732</span>   <span class="mi">1</span> <span class="n">ALL</span> <span class="n">UPO</span>
      <span class="o">-</span><span class="mf">4.0794</span>     <span class="o">-</span><span class="mf">2.3559</span>     <span class="o">-</span><span class="mf">3.9732</span>   <span class="mi">1</span> <span class="n">ALL</span> <span class="n">UPO</span>
      <span class="o">-</span><span class="mf">4.1665</span>      <span class="mf">3.8824</span>      <span class="mf">2.9754</span>   <span class="mi">7</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">4.1665</span>      <span class="mf">3.8824</span>      <span class="mf">2.9754</span>   <span class="mi">7</span> <span class="n">ALL</span> <span class="n">UPO</span>
      <span class="o">-</span><span class="mf">4.1665</span>     <span class="o">-</span><span class="mf">3.8824</span>      <span class="mf">2.9754</span>   <span class="mi">7</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">4.1665</span>     <span class="o">-</span><span class="mf">3.8824</span>      <span class="mf">2.9754</span>   <span class="mi">7</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">0.0000</span>      <span class="mf">2.6433</span>     <span class="o">-</span><span class="mf">3.9697</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">0.0000</span>     <span class="o">-</span><span class="mf">2.6433</span>     <span class="o">-</span><span class="mf">3.9697</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">2.2925</span>      <span class="mf">1.3220</span>     <span class="o">-</span><span class="mf">3.9702</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
      <span class="o">-</span><span class="mf">2.2925</span>      <span class="mf">1.3220</span>     <span class="o">-</span><span class="mf">3.9702</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">2.2925</span>     <span class="o">-</span><span class="mf">1.3220</span>     <span class="o">-</span><span class="mf">3.9702</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
      <span class="o">-</span><span class="mf">2.2925</span>     <span class="o">-</span><span class="mf">1.3220</span>     <span class="o">-</span><span class="mf">3.9702</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">0.0000</span>      <span class="mf">1.2969</span>      <span class="mf">2.9150</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">0.0000</span>     <span class="o">-</span><span class="mf">1.2969</span>      <span class="mf">2.9150</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
      <span class="o">-</span><span class="mf">2.3072</span>      <span class="mf">2.7100</span>      <span class="mf">2.9357</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">2.3072</span>      <span class="mf">2.7100</span>      <span class="mf">2.9357</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
      <span class="o">-</span><span class="mf">2.3072</span>     <span class="o">-</span><span class="mf">2.7100</span>      <span class="mf">2.9357</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">2.3072</span>     <span class="o">-</span><span class="mf">2.7100</span>      <span class="mf">2.9357</span>   <span class="mi">6</span> <span class="n">ALL</span> <span class="n">UPO</span>
       <span class="mf">0.0000</span>      <span class="mf">0.0000</span> <span class="n">Net</span> <span class="n">Charge</span> <span class="ow">and</span> <span class="n">Moment</span>
</pre></div>
</div>
<p>However, density of states is not a calculation that is normally done when you run NRLMOL, it has to be requested as a post-convergence calculation. That is, once the SCF cycle has converged, this calculation is now executed.</p>
<p>In order to request it, you have to set the option <em>DOSOCCUV</em> to <em>‘Y’</em> in the <strong>NRLMOL_INPUT.DAT</strong> file. For older versions of NRLMOL, you have to create an empty file called <strong>DOSOCCU</strong> to request the calculation.</p>
<p>So, to get the density of states calculated, you need the following:</p>
<ul class="simple">
<li><p>The binary file (the program itself)</p></li>
<li><p>The <strong>CLUSTER</strong> file</p></li>
<li><p>Either the <strong>NRLMOL_INPUT.DAT</strong> with the option set or an empty file called <strong>DOSOCCU</strong></p></li>
</ul>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this heading"></a></h2>
<p>Once the program finishes, it should have generated a list of files called <strong>DOSO001</strong>, <strong>DOSO002</strong>, and so forth (one for every atom in the structure you ran, there should be 22 files for our case of TCNE-Benzene).</p>
<p>The files may also have other starting names (<strong>AF1O, AF2O, MINO, MAJO</strong>) depending on the type of calculation you set up.</p>
<p>So basically, we have a density of states file for every atom in our system that we must plot, but how do we know which file corresponds to what atom? Do we follow the order from the <strong>CLUSTER</strong> file? The answer is no, because NRLMOL orders the atoms once it processes the <strong>CLUSTER</strong> file.</p>
<p>However, remember that NRLMOL prints a file called <strong>XMOL.DAT</strong> which is basically an <em>xyz</em> file to visualize the molecule with Jmol[3] or any other molecular viewer, it contains a listing for the atoms calculated. The order of the atoms in this file is the same order followed by the DOS files.</p>
<p>Here is the contents of <strong>XMOL.DAT</strong> for our TCNE-Benzene:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="mi">22</span>
<span class="n">TCNE</span><span class="o">-</span><span class="n">Benzene</span>
    <span class="mi">6</span>    <span class="mf">0.00000</span>    <span class="mf">1.39877</span>   <span class="o">-</span><span class="mf">2.10067</span>
    <span class="mi">6</span>    <span class="mf">0.00000</span>   <span class="o">-</span><span class="mf">1.39877</span>   <span class="o">-</span><span class="mf">2.10067</span>
    <span class="mi">6</span>    <span class="mf">1.21314</span>    <span class="mf">0.69957</span>   <span class="o">-</span><span class="mf">2.10094</span>
    <span class="mi">6</span>   <span class="o">-</span><span class="mf">1.21314</span>    <span class="mf">0.69957</span>   <span class="o">-</span><span class="mf">2.10094</span>
    <span class="mi">6</span>    <span class="mf">1.21314</span>   <span class="o">-</span><span class="mf">0.69957</span>   <span class="o">-</span><span class="mf">2.10094</span>
    <span class="mi">6</span>   <span class="o">-</span><span class="mf">1.21314</span>   <span class="o">-</span><span class="mf">0.69957</span>   <span class="o">-</span><span class="mf">2.10094</span>
    <span class="mi">6</span>    <span class="mf">0.00000</span>    <span class="mf">0.68629</span>    <span class="mf">1.54255</span>
    <span class="mi">6</span>    <span class="mf">0.00000</span>   <span class="o">-</span><span class="mf">0.68629</span>    <span class="mf">1.54255</span>
    <span class="mi">6</span>   <span class="o">-</span><span class="mf">1.22092</span>    <span class="mf">1.43407</span>    <span class="mf">1.55350</span>
    <span class="mi">6</span>    <span class="mf">1.22092</span>    <span class="mf">1.43407</span>    <span class="mf">1.55350</span>
    <span class="mi">6</span>   <span class="o">-</span><span class="mf">1.22092</span>   <span class="o">-</span><span class="mf">1.43407</span>    <span class="mf">1.55350</span>
    <span class="mi">6</span>    <span class="mf">1.22092</span>   <span class="o">-</span><span class="mf">1.43407</span>    <span class="mf">1.55350</span>
    <span class="mi">1</span>    <span class="mf">0.00000</span>    <span class="mf">2.49131</span>   <span class="o">-</span><span class="mf">2.10485</span>
    <span class="mi">1</span>    <span class="mf">0.00000</span>   <span class="o">-</span><span class="mf">2.49131</span>   <span class="o">-</span><span class="mf">2.10485</span>
    <span class="mi">1</span>    <span class="mf">2.15872</span>    <span class="mf">1.24669</span>   <span class="o">-</span><span class="mf">2.10253</span>
    <span class="mi">1</span>   <span class="o">-</span><span class="mf">2.15872</span>    <span class="mf">1.24669</span>   <span class="o">-</span><span class="mf">2.10253</span>
    <span class="mi">1</span>    <span class="mf">2.15872</span>   <span class="o">-</span><span class="mf">1.24669</span>   <span class="o">-</span><span class="mf">2.10253</span>
    <span class="mi">1</span>   <span class="o">-</span><span class="mf">2.15872</span>   <span class="o">-</span><span class="mf">1.24669</span>   <span class="o">-</span><span class="mf">2.10253</span>
    <span class="mi">7</span>   <span class="o">-</span><span class="mf">2.20482</span>    <span class="mf">2.05448</span>    <span class="mf">1.57451</span>
    <span class="mi">7</span>    <span class="mf">2.20482</span>    <span class="mf">2.05448</span>    <span class="mf">1.57451</span>
    <span class="mi">7</span>   <span class="o">-</span><span class="mf">2.20482</span>   <span class="o">-</span><span class="mf">2.05448</span>    <span class="mf">1.57451</span>
    <span class="mi">7</span>    <span class="mf">2.20482</span>   <span class="o">-</span><span class="mf">2.05448</span>    <span class="mf">1.57451</span>

</pre></div>
</div>
<p>As you can see from this listing, the atoms do not have the same order as in the <strong>CLUSTER</strong> file. Usually, NRLMOL orders atoms by listing carbons first, then hydrogens and the the rest of the atoms (it’s the standard ordering for molecules in Chemistry).</p>
<p>From the listing, we now know that the first 12 DOS files correspond to the carbons, files 13-18 correspond to the hydrogens and files 19-22 correspond to the nitrogens. So now we have to plot the DOS files for each of the components and for the full complex, but in order to do so we are going to need membership files.</p>
</section>
<section id="membership-files">
<h2>Membership files<a class="headerlink" href="#membership-files" title="Permalink to this heading"></a></h2>
<p>So far, we know that the <strong>DOSO</strong> files generated are for each atom in the system, and they follow the ordering from the <strong>XMOL.DAT</strong> file, so let’s put them side by side for clarity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="mi">22</span>
<span class="n">TCNE</span><span class="o">-</span><span class="n">Benzene</span>
    <span class="mi">6</span>    <span class="mf">0.00000</span>    <span class="mf">1.39877</span>   <span class="o">-</span><span class="mf">2.10067</span> <span class="o">-&gt;</span> <span class="n">DOSO001</span>
    <span class="mi">6</span>    <span class="mf">0.00000</span>   <span class="o">-</span><span class="mf">1.39877</span>   <span class="o">-</span><span class="mf">2.10067</span> <span class="o">-&gt;</span> <span class="n">DOSO002</span>
    <span class="mi">6</span>    <span class="mf">1.21314</span>    <span class="mf">0.69957</span>   <span class="o">-</span><span class="mf">2.10094</span> <span class="o">-&gt;</span> <span class="n">DOSO003</span>
    <span class="mi">6</span>   <span class="o">-</span><span class="mf">1.21314</span>    <span class="mf">0.69957</span>   <span class="o">-</span><span class="mf">2.10094</span> <span class="o">-&gt;</span> <span class="n">DOSO004</span>
    <span class="mi">6</span>    <span class="mf">1.21314</span>   <span class="o">-</span><span class="mf">0.69957</span>   <span class="o">-</span><span class="mf">2.10094</span> <span class="o">-&gt;</span> <span class="n">DOSO005</span>
    <span class="mi">6</span>   <span class="o">-</span><span class="mf">1.21314</span>   <span class="o">-</span><span class="mf">0.69957</span>   <span class="o">-</span><span class="mf">2.10094</span> <span class="o">-&gt;</span> <span class="n">DOSO006</span>
    <span class="mi">6</span>    <span class="mf">0.00000</span>    <span class="mf">0.68629</span>    <span class="mf">1.54255</span> <span class="o">-&gt;</span> <span class="n">DOSO007</span>
    <span class="mi">6</span>    <span class="mf">0.00000</span>   <span class="o">-</span><span class="mf">0.68629</span>    <span class="mf">1.54255</span> <span class="o">-&gt;</span> <span class="n">DOSO008</span>
    <span class="mi">6</span>   <span class="o">-</span><span class="mf">1.22092</span>    <span class="mf">1.43407</span>    <span class="mf">1.55350</span> <span class="o">-&gt;</span> <span class="n">DOSO009</span>
    <span class="mi">6</span>    <span class="mf">1.22092</span>    <span class="mf">1.43407</span>    <span class="mf">1.55350</span> <span class="o">-&gt;</span> <span class="n">DOSO010</span>
    <span class="mi">6</span>   <span class="o">-</span><span class="mf">1.22092</span>   <span class="o">-</span><span class="mf">1.43407</span>    <span class="mf">1.55350</span> <span class="o">-&gt;</span> <span class="n">DOSO011</span>
    <span class="mi">6</span>    <span class="mf">1.22092</span>   <span class="o">-</span><span class="mf">1.43407</span>    <span class="mf">1.55350</span> <span class="o">-&gt;</span> <span class="n">DOSO012</span>
    <span class="mi">1</span>    <span class="mf">0.00000</span>    <span class="mf">2.49131</span>   <span class="o">-</span><span class="mf">2.10485</span> <span class="o">-&gt;</span> <span class="n">DOSO013</span>
    <span class="mi">1</span>    <span class="mf">0.00000</span>   <span class="o">-</span><span class="mf">2.49131</span>   <span class="o">-</span><span class="mf">2.10485</span> <span class="o">-&gt;</span> <span class="n">DOSO014</span>
    <span class="mi">1</span>    <span class="mf">2.15872</span>    <span class="mf">1.24669</span>   <span class="o">-</span><span class="mf">2.10253</span> <span class="o">-&gt;</span> <span class="n">DOSO015</span>
    <span class="mi">1</span>   <span class="o">-</span><span class="mf">2.15872</span>    <span class="mf">1.24669</span>   <span class="o">-</span><span class="mf">2.10253</span> <span class="o">-&gt;</span> <span class="n">DOSO016</span>
    <span class="mi">1</span>    <span class="mf">2.15872</span>   <span class="o">-</span><span class="mf">1.24669</span>   <span class="o">-</span><span class="mf">2.10253</span> <span class="o">-&gt;</span> <span class="n">DOSO017</span>
    <span class="mi">1</span>   <span class="o">-</span><span class="mf">2.15872</span>   <span class="o">-</span><span class="mf">1.24669</span>   <span class="o">-</span><span class="mf">2.10253</span> <span class="o">-&gt;</span> <span class="n">DOSO018</span>
    <span class="mi">7</span>   <span class="o">-</span><span class="mf">2.20482</span>    <span class="mf">2.05448</span>    <span class="mf">1.57451</span> <span class="o">-&gt;</span> <span class="n">DOSO019</span>
    <span class="mi">7</span>    <span class="mf">2.20482</span>    <span class="mf">2.05448</span>    <span class="mf">1.57451</span> <span class="o">-&gt;</span> <span class="n">DOSO020</span>
    <span class="mi">7</span>   <span class="o">-</span><span class="mf">2.20482</span>   <span class="o">-</span><span class="mf">2.05448</span>    <span class="mf">1.57451</span> <span class="o">-&gt;</span> <span class="n">DOSO021</span>
    <span class="mi">7</span>    <span class="mf">2.20482</span>   <span class="o">-</span><span class="mf">2.05448</span>    <span class="mf">1.57451</span> <span class="o">-&gt;</span> <span class="n">DOSO022</span>
</pre></div>
</div>
<p>We can see from here that file <strong>DOSO0007</strong> corresponds to the seventh carbon atom, file <strong>DOSO013</strong> corresponds to the first hydrogen atom and so forth. As we previously stated, we need to generate three DOS plots: One for the full complex, one for the Benzene and one for the TCNE.</p>
<p>We clearly can see that the hydrogens belong to the Benzene and the nitrogens to the TCNE, but which carbons belong to the Benzene and which belong to the TCNE? we have no way of knowing this, so we need to open the <strong>XMOL.DAT</strong> file with Jmol to visualize the strucutre. Once you open it with Jmol, by positioning the cursor over a single atom it will tell you what number it is from the list, jot this number down and make a list for each atom of TCNE and benzene separately.</p>
<p>From this information you can create a membership list of the atom indexes for each of the substructures. For benzene, with the help of Jmol we know that carbon atoms 1-6 belong to the benzene and carbon atoms 7-12 belong to the TCNE. Therefore, the complete membership for benzene (fig. 2) is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">5</span>
<span class="mi">6</span>
<span class="mi">13</span>
<span class="mi">14</span>
<span class="mi">15</span>
<span class="mi">16</span>
<span class="mi">17</span>
<span class="mi">18</span>

</pre></div>
</div>
<p>which are the indexes for the six carbon and the six hydrogen atoms.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/frag1.png"><img alt="Benzene." src="../../_images/frag1.png" style="width: 271.2px; height: 245.1px;" /></a>
</figure>
<p>For TCNE (fig. 3) the membership is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">7</span>
<span class="mi">8</span>
<span class="mi">9</span>
<span class="mi">10</span>
<span class="mi">11</span>
<span class="mi">12</span>
<span class="mi">19</span>
<span class="mi">20</span>
<span class="mi">21</span>
<span class="mi">22</span>

</pre></div>
</div>
<p>wich are the six carbon atoms and the four nitrogen atoms.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/frag2.png"><img alt="TCNE." src="../../_images/frag2.png" style="width: 243.29999999999998px; height: 237.89999999999998px;" /></a>
</figure>
<p>We must now use this listings to create the membership files for plotting the DOS for each substructure, we only need to put in the first line of the membership file the total atoms for that membership. The membership file for benzene (let’s call it <strong>benzene.mem</strong>) is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">12</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">5</span>
<span class="mi">6</span>
<span class="mi">13</span>
<span class="mi">14</span>
<span class="mi">15</span>
<span class="mi">16</span>
<span class="mi">17</span>
<span class="mi">18</span>
</pre></div>
</div>
<p>In general, the ordering of the atom indexes is not necessary, it’s just shown here for clarity.</p>
<p>Similarly the membership file for TCNE (let’s call it <strong>tcne.mem</strong>) is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span>
<span class="mi">7</span>
<span class="mi">8</span>
<span class="mi">9</span>
<span class="mi">10</span>
<span class="mi">11</span>
<span class="mi">12</span>
<span class="mi">19</span>
<span class="mi">20</span>
<span class="mi">21</span>
<span class="mi">22</span>
</pre></div>
</div>
<p>Additionally, we must create the membership file for the full complex, this is trivial, as it is just a listing of the indexes of all the atoms in the structure (let’s call it <strong>total.mem</strong>), you can even generate it automatically with the computational tool of your choice.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">22</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">5</span>
<span class="mi">6</span>
<span class="mi">7</span>
<span class="mi">8</span>
<span class="mi">9</span>
<span class="mi">10</span>
<span class="mi">11</span>
<span class="mi">12</span>
<span class="mi">13</span>
<span class="mi">14</span>
<span class="mi">15</span>
<span class="mi">16</span>
<span class="mi">17</span>
<span class="mi">18</span>
<span class="mi">19</span>
<span class="mi">20</span>
<span class="mi">21</span>
<span class="mi">22</span>
</pre></div>
</div>
<p>Again the ordering is not important as long as each atom is listed.</p>
<p>We can now use these three membership files to plot their corresponding density of states.</p>
</section>
<section id="plotting">
<h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this heading"></a></h2>
<p>To plot the membership files, we use the NRLMOL_GUI program to do so. Set the project directory by selecting <em>Set Project Directory</em> from the <em>File</em> menu. This is the directory where you ran the calculation and that contains the DOS and other output files.  After this, select <em>Plot Density of States</em> from <em>Viewer</em> in the main menu (fig. 4).</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/gui1.png"><img alt="NRLMOL_GUI main window." src="../../_images/gui1.png" style="width: 723.2px; height: 288.0px;" /></a>
</figure>
<p>This will open the dialog box for plotting density of states (fig. 5), from here:</p>
<ul class="simple">
<li><p>Press the “Select File” button to select the membership file you want to plot.</p></li>
<li><p>Select the “Membership file” radio button to process the file as a membership file.</p></li>
<li><p>Select the “DOS file prefix” to select the prefix of your DOS files (in case they are not named (DOSO)</p></li>
<li><p>Type the titles and axis legends for the graph.</p></li>
<li><p>Click on the checkbox if you want the Fermi level to be plotted (the file <strong>EVALUES</strong> must be present in the project directory).</p></li>
<li><p>You can select to write a graphics file output, although you can do that by doing a right-click on the plot window, this second option is preferred since you can do some adjustments to the graph before saving.</p></li>
<li><p>The last check mark <em>Create data file</em> should be checked, and a file name given (only when plotting from a membership file), no extension is required as it will automatically add .dat to the file name.</p></li>
</ul>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/dos_gui.png"><img alt="DOS plotting dialog box." src="../../_images/dos_gui.png" style="width: 472.8px; height: 346.40000000000003px;" /></a>
</figure>
<p>Why should a data file be created when plotting from a membership file? Well, the process goes as this: The program will take each of the DOS files for each atom, adds them together and puts it in a file for plotting, however; if you want to plot the data yourself with another program, you can use this data file for that purpose.
After you are finished, you should now have three final data files:</p>
<ul class="simple">
<li><p>benzene.dat a data file containing the DOS information for the benzene atoms generated from the benzene.mem file.</p></li>
<li><p>tcne.dat a data file containing the DOS information for the tcne atoms generated from the tcne.mem file.</p></li>
<li><p>total.dat a data file containing the DOS information for all the atoms generated from the total.mem file.</p></li>
</ul>
<p>Let’s now use gnuplot[4] to generate the three plots in a single image from the data files.</p>
</section>
<section id="gnuplot-usage">
<h2>Gnuplot usage<a class="headerlink" href="#gnuplot-usage" title="Permalink to this heading"></a></h2>
<p>To now join together the three data files, we need to setup a gnuplot script to process the data in each file and plot them. However, we also need one extra data file for the Fermi level.</p>
<p>We get the Fermi level from the <strong>EVALUES</strong> file: open the file and look for the line containing <em>FERMI LEVEL</em> and the number next to it, the number is however given in Hartrees, so you must convert it to electron-volt by multiplying it by 27.2116. You could have also got it from the GUI, if you requested to plot the Fermi level, this goes and reads it from the file and puts in a pop up window so you can jot it down.</p>
<p>For the TCNE-Benzene this value is: -0.206529774179560 so its corresponding value in eV is -5.620005603</p>
<p>So make a file called <strong>fermi.dat</strong> and put this two lines in it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">5.620005603</span> <span class="mi">0</span>
<span class="o">-</span><span class="mf">5.620005603</span> <span class="mi">70</span>
</pre></div>
</div>
<p>These are just two x,y pairs to be plotted. If you think about it, if the points are connected on a graph, they will generate a vertical line at the Fermi level (fig. 6).
We give the second point a big y value (70 in this case, it can be naything) to make shure we cover all the plot surface.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/fermi1.png"><img alt="Plot of the fermi.dat file" src="../../_images/fermi1.png" style="width: 512.0px; height: 320.0px;" /></a>
</figure>
<p>Now we are ready to configure the plotting script for gnuplot. This is just a text file (let’s call it <strong>plot_sample.p</strong>) that conatins the following lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This file will create a stacked plot for DOS</span>
<span class="nb">set</span> <span class="n">terminal</span> <span class="n">png</span> <span class="n">size</span> <span class="mi">1200</span><span class="p">,</span><span class="mi">900</span> <span class="n">linewidth</span> <span class="mi">3</span>
<span class="nb">set</span> <span class="n">output</span> <span class="s1">&#39;DOSplot_sample.png&#39;</span>
<span class="nb">set</span> <span class="n">linestyle</span> <span class="mi">1</span> <span class="n">linecolor</span> <span class="n">rgb</span> <span class="s1">&#39;blue&#39;</span>
<span class="nb">set</span> <span class="n">linestyle</span> <span class="mi">2</span> <span class="n">linecolor</span> <span class="n">rgb</span> <span class="s1">&#39;red&#39;</span>
<span class="nb">set</span> <span class="n">multiplot</span> <span class="n">layout</span> <span class="mi">3</span><span class="p">,</span><span class="mi">1</span>
<span class="c1"># first plot top</span>
<span class="nb">set</span> <span class="n">bmargin</span> <span class="n">at</span> <span class="n">screen</span> <span class="mf">0.65</span>
<span class="nb">set</span> <span class="n">tmargin</span> <span class="n">at</span> <span class="n">screen</span> <span class="mf">0.95</span>
<span class="nb">set</span> <span class="n">xrange</span><span class="p">[</span><span class="o">-</span><span class="mi">12</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">set</span> <span class="n">yrange</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="nb">set</span> <span class="n">xtics</span> <span class="nb">format</span> <span class="s1">&#39; &#39;</span>
<span class="nb">set</span> <span class="n">ytics</span> <span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span>
<span class="n">plot</span> <span class="s1">&#39;tcne.dat&#39;</span> <span class="k">with</span> <span class="n">lines</span> <span class="n">linestyle</span> <span class="mi">1</span> <span class="n">notitle</span><span class="p">,</span><span class="s1">&#39;fermi.dat&#39;</span> <span class="k">with</span> <span class="n">lines</span> <span class="n">linestyle</span> <span class="mi">2</span> <span class="n">notitle</span>
<span class="c1"># Second plot middle</span>
<span class="nb">set</span> <span class="n">bmargin</span> <span class="n">at</span> <span class="n">screen</span> <span class="mf">0.35</span>
<span class="nb">set</span> <span class="n">tmargin</span> <span class="n">at</span> <span class="n">screen</span> <span class="mf">0.65</span>
<span class="n">plot</span> <span class="s1">&#39;benzene.dat&#39;</span> <span class="k">with</span> <span class="n">lines</span> <span class="n">linestyle</span> <span class="mi">1</span> <span class="n">notitle</span><span class="p">,</span><span class="s1">&#39;fermi.dat&#39;</span> <span class="k">with</span> <span class="n">lines</span> <span class="n">linestyle</span> <span class="mi">2</span> <span class="n">notitle</span>
<span class="c1"># Third plot</span>
<span class="nb">set</span> <span class="n">bmargin</span> <span class="n">at</span> <span class="n">screen</span> <span class="mf">0.05</span>
<span class="nb">set</span> <span class="n">tmargin</span> <span class="n">at</span> <span class="n">screen</span> <span class="mf">0.35</span>
<span class="nb">set</span> <span class="n">xtics</span> <span class="nb">format</span> <span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span>
<span class="n">plot</span> <span class="s1">&#39;all.dat&#39;</span> <span class="k">with</span> <span class="n">lines</span> <span class="n">linestyle</span> <span class="mi">1</span> <span class="n">notitle</span><span class="p">,</span><span class="s1">&#39;fermi.dat&#39;</span> <span class="k">with</span> <span class="n">lines</span> <span class="n">linestyle</span> <span class="mi">2</span> <span class="n">notitle</span>
<span class="n">unset</span> <span class="n">multiplot</span>

</pre></div>
</div>
<p>Lines that begin with <em>#</em> are comments and are thus ignored. The configurable options are:</p>
<ul class="simple">
<li><p>We set a terminal output of png, this means we will generate a <em>.png</em> graphic file</p></li>
<li><p>The requested linewidth is 3 is needed for publication qualitiy graphs.</p></li>
<li><p>The <em>set output</em> line specifies the file name of the generated file.</p></li>
<li><p>Two linestyles are defined, which specify the line colors for the DOS data and Fermi level respectively.</p></li>
<li><p>We remove unnecessary data by adjusting the x range (usually on the unoccupied states) to the left of the Fermi level (set xrange[-12:0]).</p></li>
<li><p>We adjust the y range so all plots have the same height (set yrange[0:10]).</p></li>
<li><p>We remove any number on the x axis until the last plot with: set xtics format ‘ ‘</p></li>
<li><p>The set ytics 0,2,8 means that the y range will be printed from 0 to 8 in increments of 2.</p></li>
<li><p>You can change the order of the plots by specifying the name of the <em>.dat</em> file in each section (just don’t forget to include the <em>fermi.dat</em> file).</p></li>
</ul>
<p>Once you set this up, run the script through gnuplot with the folowing command (in Linux, other platforms are untested):</p>
<p><em>gnuplot plot_sample.p</em></p>
<p>You may need to run this command several times, while adjusting the values in the gnuplot script.</p>
<p>Once you get plot you’re confortable with (fig. 7), you still need to include the Axis labels as well as the descriptions of the individual plots (what part of the molecule each section represents), this can be done with any graphical editor (in the lab I usually use the GIMP[5] package, but it can be done with a presentation editor) to edit the png file (fig. 8).</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/DOSplot_sample.png"><img alt="Plot of data files" src="../../_images/DOSplot_sample.png" style="width: 480.0px; height: 360.0px;" /></a>
</figure>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/DOSplot_samplef.png"><img alt="Final touches to the graphic file" src="../../_images/DOSplot_samplef.png" style="width: 519.2px; height: 391.20000000000005px;" /></a>
</figure>
</section>
<section id="bibliography">
<h2>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>David S. Sholll &amp;  Janice A. Steckel, <em>Density Functional Theory: A practical Introduction</em>, Wiley (2009).</p></li>
<li><p>Ricahrd M. Martin, <em>Electronic Structure, Basic Theory and Practical Methods</em>, Cambridge University Press (2013).</p></li>
<li><p>Jmol: An open-source Java viewer for chemical structures in 3D. <a class="reference external" href="http://www.jmol.org">http://www.jmol.org</a></p></li>
<li><p>gnuplot: A portable command-line driven graphing utility. <a class="reference external" href="http://www.gnuplot.info">http://www.gnuplot.info</a></p></li>
<li><p>GIMP: The GNU Image Manipulation Program. <a class="reference external" href="http://www.gimp.org">http://www.gimp.org</a></p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../dtutorials/T3-FOD_opt.html" class="btn btn-neutral float-left" title="Tutorial 3: FOD optimization of a water molecule" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../docs/nrlmolfaq.html" class="btn btn-neutral float-right" title="Getting more information about FLOSIC" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023,   NRLMOL users .
      <span class="lastupdated">Last updated on Mar 11, 2023.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>