
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Tutorial 2: Understanding electronic structure of molecules using NRLMOL &#8212; NRLMOL  0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../nrlmoldoc_main.html">NRLMOL  0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial-2-understanding-electronic-structure-of-molecules-using-nrlmol">
<h1>Tutorial 2: Understanding electronic structure of molecules using NRLMOL<a class="headerlink" href="#tutorial-2-understanding-electronic-structure-of-molecules-using-nrlmol" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial we will learn to optimize the geometries of diatomic molecules.
We choose the case of H2 molecule.
Again, as a reminder the <strong>CLUSTER</strong> file is the main input file of NRLMOL. It contains
the minimal information to set up the calculation. See below the CLUSTER file for the hydrogen molecule.</p>
<p>We will now describe the input structure of this file.
The first line is <strong>GGA-PBE*GGA-PBE</strong>. It specifies that the electron-electron exchange and correlation interactions in the
systems are modeled within the generalized gradient approximation (GGA) using the Perdew-Burke-Ernzerhof
(PBE) parametrization. This is the default functional used in NRLMOL. A few other functionals are also
available.</p>
<p>The second line is <strong>GRP</strong>. It refers to point group symmetry. The GRP means the symmetry point group
operations will be read from the GRPMAT file. A few selected symmetry groups such as Ih, Td, Th, C3V
etc. can also be provided here. In this case the GRPMAT corresponding to specified point group will be
automatically generated by NRLMOL. Even though the H2 molecule posses symmetry we will perform
calculation without symmetry. We will learn how to use symmetry to speed up calculations in the next tutorial.
So keep “GRP” line as it is. The GRPMAT file will be created automatically and will contain the
identity matrix only.</p>
<p>The third line specifies the number of inequivalent atoms in calculations. Since we are not making use of point group
symmetry, the number of inequivalent atoms is same as total number of atoms, which is 2 in this case.</p>
<p>The lines following the third line contain information for each of the inequivalent atoms.
The first three numbers are the cartesian positions in atomic units, its atomic number, and
string ALL. In this example, we have placed one hydrogen atom at (0,0,Z) and the second one at (0,0,-Z).
You can put the atoms anywhere. Atomic positions should be given in atomic units, Bohr.
Followed by xyz coordinates is the atomic charge. The example listed is for hydrogen
whose atomic number is 1. The string ALL signifies that the calculations are to be performed
at the all-electron level. It is also possible to use pseudopotentials. Only the BHS pseudopotentials
are hardwired into the code. It is also possible to use user-supplied (numerical) pseudopotentials also, but
requires more work and is not recommended for beginners.</p>
<p>The last line in example has two fields. The first field is 0.0 which means perform calculation
for the neutral molecule. If it is 1 then the calculations will be performed for singly charged
cation of N atoms. The next field which is 0 in this example corresponds to number of unpaired
electrons in the system. There are no unpaired electrons in this example.
Lines after Charge and Moment line are ignored.</p>
<p>Now, copy the example input in the file called CLUSTER and run the calculation for H2 molecule
using the following sequences of commands at the prompt.</p>
<blockquote>
<div><p>$ <strong>rm -f GEOCNVRG SYMBOL ISYMGEN INPUT RUNS</strong></p>
<p>$ <strong>./cluster &lt; print.SCF</strong></p>
</div></blockquote>
<p>Now, browse through the file print.SCF and look at the energies printed at each iteration.
Also, look at the EVALUES file in which Kohn-Sham eigenvalues and occupation numbers are printed.
Try to understand the SCF process.
Now, let’s open the GEOCNVRG file:</p>
<p>The number on the first line is the optimization threshold. If the RMS gradient falls below this value then optimization of structure is complete. The following line CONVERGENCE FALSE tells us that the structure is not optimized yet, that is, the atoms have still significant forces. The next line is the total energy in Hartree for the current geometry. The last line print out the maximum rms force.
To get more information on the forces, look at the file <strong>FRCOUT</strong>.</p>
<p>The first line is the total energy in Hartree. It will also be printed in <strong>GEOCNVRG</strong>. Followed by these
are atomic positions (x,y,z) components of atom 1, which is followed by the x,y,z component’s of forces.
Similar, information is printed on subsequent lines. The second last line contains DIPOLE MOMENT while
the last line prints out the external electric field. The H2 molecule does not have dipole moment and
our calculations are in absence of electric field. Note that since we placed atoms on Z axis only the
Z component of force is nonzero. The forces are significant and tell us that atoms should be moved
away from each other. Since the forces are significant we need to repeat calculation until the forces
vanish (fall below the threshold).
So repeat following command until forces are zero which is easy to figure out by looking at <strong>GEOCNVRG</strong>.</p>
<blockquote>
<div><p>$ <strong>./cluster &gt; print.SCF</strong></p>
</div></blockquote>
<p>You can also use following script to automate optimization. For the bash shell it is :</p>
<p>Cut and paste the above script in a file called <strong>opt.bash</strong>. Then do the following to run it.</p>
<blockquote>
<div><p>$ <strong>chmod +x opt.bash</strong></p>
<p>$ <strong>./opt.bash &amp;</strong></p>
</div></blockquote>
<p>The first command will make the file <strong>opt.bash</strong> executable and the second one will run the program in background.
The final <strong>GEOCNVRG</strong> file should look something like</p>
<p>Note the second line says that CONVERGENCE is <strong>TRUE</strong> . This indicates that convergence was obtained
for the optimization job, i.e. the structure is optimized.
The final forces are in <strong>FRCOUT</strong>.</p>
<p>The final optimized coordinates are stored in “XMOL.DAT” (They are in Angstrom).</p>
<p>So the optimized bond length is 0.749 Angstrom.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/docs/tutorial2.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../nrlmoldoc_main.html">NRLMOL  0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013,   NRLMOL users .
    </div>
  </body>
</html>